{"ast":null,"code":"import _objectSpread from \"E:\\\\DoAnTotNghiep\\\\code\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"E:\\\\DoAnTotNghiep\\\\code\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\DoAnTotNghiep\\\\code\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"E:\\\\DoAnTotNghiep\\\\code\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"E:\\\\DoAnTotNghiep\\\\code\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"E:\\\\DoAnTotNghiep\\\\code\\\\Client-V2\\\\src\\\\app\\\\views\\\\EQASamplesList\\\\EQASampleEditorDialog.jsx\";\nimport React, { Component } from \"react\";\nimport { Dialog, Button, Grid, DialogActions, DialogContent, DialogTitle, Paper, Input, InputLabel, MenuItem, FormControl, TextField, Select, FormHelperText, IconButton, Icon } from \"@material-ui/core\";\nimport { MuiPickersUtilsProvider, KeyboardDatePicker, DateTimePicker } from \"@material-ui/pickers\";\nimport MaterialTable, { MTableToolbar, Chip, MTableBody, MTableHeader } from 'material-table';\nimport DateFnsUtils from \"@date-io/date-fns\";\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\nimport { ValidatorForm, TextValidator } from \"react-material-ui-form-validator\";\nimport { checkCode, deleteItem, saveItem, getItemById, updateEQASampleList, addNewEQASampleList, countByRoundId } from \"./EQASampleListService\";\nimport { searchByPage as searchByPageEQARound } from \"../EQARound/EQARoundService\";\nimport Draggable from 'react-draggable';\nimport EQASerumBottleSelectMultiple from '../Component/EQASerumBottle/EQASerumBottleSelectMultiple';\nimport AsynchronousAutocomplete from \"../utilities/AsynchronousAutocomplete\";\nimport { useTranslation, withTranslation, Trans } from 'react-i18next';\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport TabsSample from \"./Tabs\";\nimport { result } from \"lodash\";\ntoast.configure({\n  autoClose: 1000,\n  draggable: false,\n  limit: 3\n});\n\nfunction PaperComponent(props) {\n  return /*#__PURE__*/React.createElement(Draggable, {\n    handle: \"#draggable-dialog-title\",\n    cancel: '[class*=\"MuiDialogContent-root\"]',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Paper, Object.assign({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 13\n    }\n  })));\n}\n\nfunction MaterialButton(props) {\n  var item = props.item;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    size: \"small\",\n    onClick: function onClick() {\n      return props.onSelect(item, 1);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    fontSize: \"small\",\n    color: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 17\n    }\n  }, \"delete\")));\n}\n\nfunction OriginnalResult(props) {\n  var _useTranslation = useTranslation(),\n      t = _useTranslation.t,\n      i18n = _useTranslation.i18n;\n\n  var item = props.item;\n  var hivStatus = null;\n  var str = \"\";\n\n  if (item) {\n    hivStatus = item.hivStatus == 1 ? true : false;\n    str = t('eQASerumBottle.hivStatus.' + item.hivStatus);\n  }\n\n  if (hivStatus && hivStatus == true) {\n    return /*#__PURE__*/React.createElement(\"small\", {\n      className: \"border-radius-4 bg-primary text-white px-8 py-2 \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 16\n      }\n    }, str);\n  } else {\n    return /*#__PURE__*/React.createElement(\"small\", {\n      className: \"border-radius-4 bg-light-gray px-8 py-2 \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 16\n      }\n    }, str);\n  }\n}\n\nvar EQASampleEditorDialog = /*#__PURE__*/function (_Component) {\n  _inherits(EQASampleEditorDialog, _Component);\n\n  var _super = _createSuper(EQASampleEditorDialog);\n\n  function EQASampleEditorDialog(props) {\n    var _this;\n\n    _classCallCheck(this, EQASampleEditorDialog);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      name: \"\",\n      code: \"\",\n      eqaSampleBottles: [],\n      thrombinAddedDate: new Date(),\n      removeFibrinDate: new Date(),\n      centrifugeDate: new Date(),\n      shouldOpenConfirmationDialog: false,\n      shouldOpenPopupSelectEQASerumBottle: false,\n      errMessageBottle: \"\",\n      errMessageCode: \"\",\n      round: [],\n      result: null,\n      isView: false\n    };\n\n    _this.handleChange = function (event, source) {\n      event.persist();\n\n      if (source === \"active\") {\n        _this.setState({\n          hasErrorResult: false\n        });\n      }\n\n      if (source === \"hasErrorSample\") {\n        _this.setState({\n          hasErrorSample: false\n        });\n      }\n\n      _this.setState({\n        [event.target.name]: event.target.value\n      });\n    };\n\n    _this.handleDelete = function (rowData) {\n      var eqaSampleBottles = _this.state.eqaSampleBottles;\n\n      for (var index = 0; index < eqaSampleBottles.length; index++) {\n        var item = eqaSampleBottles[index];\n\n        if (rowData && item && rowData.id === item.id) {\n          eqaSampleBottles.splice(index, 1);\n\n          _this.setState({\n            eqaSampleBottles\n          });\n\n          break;\n        }\n      }\n    };\n\n    _this.handleSelectEQARound = function (item) {\n      _this.setState({\n        round: item\n      });\n\n      var numberSampleList = [];\n\n      if (item != null && item.numberSampleList != null) {\n        for (var i = 0; i < item.numberSampleList; i++) {\n          numberSampleList.push({\n            id: i + 1,\n            name: i + 1\n          });\n        }\n\n        _this.setState({\n          numberSampleList: numberSampleList\n        });\n      } else {\n        _this.setState({\n          numberSampleList: null\n        });\n      }\n    };\n\n    _this.handleFormSubmit = function () {\n      var _this$props = _this.props,\n          t = _this$props.t,\n          i18n = _this$props.i18n;\n      var _this$state = _this.state,\n          id = _this$state.id,\n          item = _this$state.item;\n      var checkNumberSample = false;\n\n      if ((item === null || item === void 0 ? void 0 : item.numberSample) != null && (item === null || item === void 0 ? void 0 : item.countSampleList) != null) {\n        if (item.numberSample > item.countSampleList) {\n          checkNumberSample = true;\n        }\n      }\n\n      console.log(checkNumberSample);\n\n      _this.setState({\n        hasErrorResult: false,\n        hasErrorSample: false,\n        hasErrorPerson: false\n      });\n\n      if (typeof _this.state.item.result == \"undefined\" || _this.state.item.result === null) {\n        item[\"hasErrorResult\"] = true;\n\n        _this.setState({\n          item: item\n        });\n\n        return;\n      } else if (typeof _this.state.item.inactiveVirus == \"undefined\" || _this.state.item.inactiveVirus === null) {\n        item[\"hasErrorVirus\"] = true;\n\n        _this.setState({\n          item: item\n        });\n\n        return;\n      } else {\n        if (item != null && item.eqaSampleBottles != null && item.eqaSampleBottles.length > 0) {\n          if (typeof item.isManualSetCode != \"undefined\" && item.isManualSetCode) {\n            checkCode(id, item.code).then(function (res) {\n              if (res.data) {\n                toast.warning(t(\"mess_code\"));\n              } else {\n                if (id) {\n                  // this.setState({isView: true});\n                  saveItem(_objectSpread({}, _this.state.item)).then(function (response) {\n                    if (response.data != null && response.status == 200) {\n                      _this.setState(_objectSpread({}, item));\n\n                      toast.success(t('mess_edit'));\n                    } // this.props.handleOKEditClose();\n\n                  }).catch(function (err) {\n                    if (err.data == null) {\n                      toast.warning(t(\"mess_edit_error\"));\n                    }\n                  });\n                } else {\n                  // this.setState({isView: true});\n                  if (_this.state.item) if (checkNumberSample) {\n                    saveItem(_objectSpread({}, _this.state.item)).then(function (response) {\n                      if (response.data != null && response.status == 200) {\n                        item.id = response.data.id;\n\n                        _this.setState(_objectSpread({}, item));\n\n                        toast.success(t('mess_add'));\n                      } // this.props.handleOKEditClose();\n\n                    }).catch(function (err) {\n                      if (err.data == null) {\n                        toast.warning(t(\"mess_add_error\"));\n                      }\n                    });\n                  } else {\n                    toast.warning(\"Số mẫu của kế hoạch này đã đủ\");\n                  }\n                }\n              }\n            });\n          } else {\n            if (id) {\n              saveItem(_objectSpread({}, _this.state.item)).then(function (response) {\n                if (response.data != null && response.status == 200) {\n                  _this.setState(_objectSpread({}, item));\n\n                  toast.success(t('mess_edit'));\n                } // this.props.handleOKEditClose();\n\n              }).catch(function (err) {\n                if (err.data == null) {\n                  toast.warning(t(\"mess_edit_error\"));\n                }\n              });\n            } else {\n              // this.setState({isView: true});\n              if (checkNumberSample) {\n                saveItem(_objectSpread({}, _this.state.item)).then(function (response) {\n                  // this.props.handleOKEditClose();\n                  if (response.data != null && response.status == 200) {\n                    item.id = response.data.id;\n\n                    _this.setState(_objectSpread({}, item));\n\n                    toast.success(t('mess_add'));\n                  }\n                }).catch(function (err) {\n                  if (err.data == null) {\n                    toast.warning(t(\"mess_add_error\"));\n                  }\n                });\n              } else {\n                toast.warning(\"Số mẫu của kế hoạch này đã đủ\");\n              }\n            }\n          }\n        } else {\n          toast.warning(t(\"SampleManagement.eqaSampleBottlesisNull\"));\n        }\n      }\n    };\n\n    _this.handleThrombinAddedDateChange = function (date) {\n      _this.setState({\n        thrombinAddedDate: date\n      });\n    };\n\n    _this.handleRemoveFibrinDateChange = function (date) {\n      _this.setState({\n        removeFibrinDate: date\n      });\n    };\n\n    _this.handleCentrifugeDateChange = function (date) {\n      _this.setState({\n        centrifugeDate: date\n      });\n    };\n\n    _this.selectBottle = function (bottles) {\n      _this.setState({\n        eqaSampleBottles: bottles\n      }, function () {});\n    };\n\n    _this.handleClosePopupSelectEQASerumBottle = function () {\n      _this.setState({\n        shouldOpenPopupSelectEQASerumBottle: false\n      }, function () {});\n    };\n\n    _this.handleSelectEQASerumBottle = function (item) {\n      // item.sort((a, b) => (a.eQASerumBottle.code > b.eQASerumBottle.code) ? 1 : -1);\n      // this.setState({ eqaSampleBottles: item }, function () {\n      //     this.handleClosePopupSelectEQASerumBottle();\n      // });\n      var data = item.map(function (row) {\n        return _objectSpread({}, row);\n      });\n\n      _this.setState({\n        eqaSampleBottles: data\n      });\n\n      _this.handleClosePopupSelectEQASerumBottle();\n    };\n\n    return _this;\n  }\n\n  _createClass(EQASampleEditorDialog, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {}\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this$props2 = this.props,\n          open = _this$props2.open,\n          handleClose = _this$props2.handleClose,\n          item = _this$props2.item;\n      this.setState({\n        item: item\n      });\n      var numberSampleList = [];\n\n      if (item && item.eqaSampleBottles && item.eqaSampleBottles.length > 0) {\n        item.eqaSampleBottles.sort(function (a, b) {\n          return a.eQASerumBottle.code > b.eQASerumBottle.code ? 1 : -1;\n        });\n      }\n\n      if (item.round != null && item.round.numberSampleList != null) {\n        for (var i = 0; i < item.round.numberSampleList; i++) {\n          numberSampleList.push({\n            id: i + 1,\n            name: i + 1\n          });\n        }\n\n        this.setState({\n          numberSampleList: numberSampleList\n        });\n      } else {\n        this.setState({\n          numberSampleList: null\n        });\n      }\n\n      this.setState(_objectSpread({}, item));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          i18n = _this$props3.i18n,\n          t = _this$props3.t,\n          handleClose = _this$props3.handleClose,\n          open = _this$props3.open;\n      var _this$state2 = this.state,\n          id = _this$state2.id,\n          name = _this$state2.name,\n          code = _this$state2.code,\n          result = _this$state2.result,\n          round = _this$state2.round,\n          eqaSampleBottles = _this$state2.eqaSampleBottles,\n          additiveThrombin = _this$state2.additiveThrombin,\n          thrombinAddedDate = _this$state2.thrombinAddedDate,\n          inactiveVirus = _this$state2.inactiveVirus,\n          volumeAfterRemoveFibrin = _this$state2.volumeAfterRemoveFibrin,\n          removeFibrinDate = _this$state2.removeFibrinDate,\n          volumeAfterCentrifuge = _this$state2.volumeAfterCentrifuge,\n          centrifugeDate = _this$state2.centrifugeDate,\n          volumeOfProclinAdded = _this$state2.volumeOfProclinAdded,\n          note = _this$state2.note,\n          orderNumberSample = _this$state2.orderNumberSample,\n          numberSampleList = _this$state2.numberSampleList,\n          numberSample = _this$state2.numberSample,\n          hasErrorSample = _this$state2.hasErrorSample,\n          hasErrorResult = _this$state2.hasErrorResult,\n          isView = _this$state2.isView,\n          shouldOpenPopupSelectEQASerumBottle = _this$state2.shouldOpenPopupSelectEQASerumBottle;\n      return /*#__PURE__*/React.createElement(Dialog, {\n        open: open,\n        PaperComponent: PaperComponent,\n        maxWidth: 'lg',\n        fullWidth: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 354,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(DialogTitle, {\n        style: {\n          cursor: 'move'\n        },\n        id: \"draggable-dialog-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"mb-20 styleColor\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 21\n        }\n      }, \" \", (id ? t(\"update\") : t(\"Add\")) + \" \" + t(\"SampleManagement.sample-list.title\"), \" \"), /*#__PURE__*/React.createElement(IconButton, {\n        style: {\n          position: \"absolute\",\n          right: \"10px\",\n          top: \"10px\"\n        },\n        onClick: function onClick() {\n          return handleClose();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Icon, {\n        color: \"error\",\n        title: t(\"close\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 124\n        }\n      }, \"close\"))), /*#__PURE__*/React.createElement(ValidatorForm, {\n        ref: \"form\",\n        onSubmit: this.handleFormSubmit,\n        style: {\n          overflowY: \"auto\",\n          display: \"flex\",\n          flexDirection: \"column\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(DialogContent, {\n        dividers: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(TabsSample, {\n        t: t,\n        i18n: i18n,\n        item: this.state.item,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 29\n        }\n      }))), /*#__PURE__*/React.createElement(DialogActions, {\n        spacing: 4,\n        className: \"flex flex-end flex-middle\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 377,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        variant: \"contained\",\n        className: \"mr-16\",\n        color: \"secondary\",\n        type: \"button\",\n        onClick: function onClick() {\n          return handleClose();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 25\n        }\n      }, \" \", t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n        disabled: isView,\n        variant: \"contained\",\n        color: \"primary\",\n        className: \" mr-16 align-bottom\",\n        type: \"submit\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 25\n        }\n      }, t('Save')))));\n    }\n  }]);\n\n  return EQASampleEditorDialog;\n}(Component);\n\nexport default EQASampleEditorDialog;","map":{"version":3,"sources":["E:/DoAnTotNghiep/code/Client-V2/src/app/views/EQASamplesList/EQASampleEditorDialog.jsx"],"names":["React","Component","Dialog","Button","Grid","DialogActions","DialogContent","DialogTitle","Paper","Input","InputLabel","MenuItem","FormControl","TextField","Select","FormHelperText","IconButton","Icon","MuiPickersUtilsProvider","KeyboardDatePicker","DateTimePicker","MaterialTable","MTableToolbar","Chip","MTableBody","MTableHeader","DateFnsUtils","Autocomplete","ValidatorForm","TextValidator","checkCode","deleteItem","saveItem","getItemById","updateEQASampleList","addNewEQASampleList","countByRoundId","searchByPage","searchByPageEQARound","Draggable","EQASerumBottleSelectMultiple","AsynchronousAutocomplete","useTranslation","withTranslation","Trans","toast","TabsSample","result","configure","autoClose","draggable","limit","PaperComponent","props","MaterialButton","item","onSelect","OriginnalResult","t","i18n","hivStatus","str","EQASampleEditorDialog","state","name","code","eqaSampleBottles","thrombinAddedDate","Date","removeFibrinDate","centrifugeDate","shouldOpenConfirmationDialog","shouldOpenPopupSelectEQASerumBottle","errMessageBottle","errMessageCode","round","isView","handleChange","event","source","persist","setState","hasErrorResult","hasErrorSample","target","value","handleDelete","rowData","index","length","id","splice","handleSelectEQARound","numberSampleList","i","push","handleFormSubmit","checkNumberSample","numberSample","countSampleList","console","log","hasErrorPerson","inactiveVirus","isManualSetCode","then","res","data","warning","response","status","success","catch","err","handleThrombinAddedDateChange","date","handleRemoveFibrinDateChange","handleCentrifugeDateChange","selectBottle","bottles","handleClosePopupSelectEQASerumBottle","handleSelectEQASerumBottle","map","row","open","handleClose","sort","a","b","eQASerumBottle","additiveThrombin","volumeAfterRemoveFibrin","volumeAfterCentrifuge","volumeOfProclinAdded","note","orderNumberSample","cursor","position","right","top","overflowY","display","flexDirection"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport {\r\n    Dialog,\r\n    Button,\r\n    Grid,\r\n    DialogActions,\r\n    DialogContent,\r\n    DialogTitle,\r\n    Paper,\r\n    Input,\r\n    InputLabel,\r\n    MenuItem,\r\n    FormControl, TextField,\r\n    Select, FormHelperText, IconButton, Icon\r\n} from \"@material-ui/core\";\r\nimport {\r\n    MuiPickersUtilsProvider,\r\n    KeyboardDatePicker,\r\n    DateTimePicker\r\n} from \"@material-ui/pickers\";\r\nimport MaterialTable, { MTableToolbar, Chip, MTableBody, MTableHeader } from 'material-table';\r\nimport DateFnsUtils from \"@date-io/date-fns\";\r\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\r\nimport { ValidatorForm, TextValidator } from \"react-material-ui-form-validator\";\r\nimport { checkCode, deleteItem, saveItem, getItemById, updateEQASampleList, addNewEQASampleList, countByRoundId } from \"./EQASampleListService\";\r\nimport { searchByPage as searchByPageEQARound } from \"../EQARound/EQARoundService\";\r\nimport Draggable from 'react-draggable';\r\nimport EQASerumBottleSelectMultiple from '../Component/EQASerumBottle/EQASerumBottleSelectMultiple';\r\nimport AsynchronousAutocomplete from \"../utilities/AsynchronousAutocomplete\";\r\nimport { useTranslation, withTranslation, Trans } from 'react-i18next';\r\nimport { toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport TabsSample from \"./Tabs\";\r\nimport { result } from \"lodash\";\r\n\r\ntoast.configure({\r\n    autoClose: 1000,\r\n    draggable: false,\r\n    limit: 3\r\n});\r\nfunction PaperComponent(props) {\r\n    return (\r\n        <Draggable handle=\"#draggable-dialog-title\" cancel={'[class*=\"MuiDialogContent-root\"]'}>\r\n            <Paper {...props} />\r\n        </Draggable>\r\n    );\r\n}\r\nfunction MaterialButton(props) {\r\n    const item = props.item;\r\n    return (\r\n        <div>\r\n            <IconButton size=\"small\" onClick={() => props.onSelect(item, 1)}>\r\n                <Icon fontSize=\"small\" color=\"error\">delete</Icon>\r\n            </IconButton>\r\n        </div>\r\n    );\r\n}\r\nfunction OriginnalResult(props) {\r\n    const { t, i18n } = useTranslation();\r\n    const item = props.item;\r\n    let hivStatus = null;\r\n    let str = \"\";\r\n    if (item) {\r\n        hivStatus = item.hivStatus == 1 ? true : false;\r\n        str = t('eQASerumBottle.hivStatus.' + item.hivStatus);\r\n    }\r\n\r\n    if (hivStatus && hivStatus == true) {\r\n        return <small className=\"border-radius-4 bg-primary text-white px-8 py-2 \">{str}</small>;\r\n    }\r\n    else {\r\n        return <small className=\"border-radius-4 bg-light-gray px-8 py-2 \">{str}</small>;\r\n    }\r\n}\r\n\r\nclass EQASampleEditorDialog extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n    }\r\n    state = {\r\n        name: \"\",\r\n        code: \"\",\r\n        eqaSampleBottles: [],\r\n        thrombinAddedDate: new Date(),\r\n        removeFibrinDate: new Date(),\r\n        centrifugeDate: new Date(),\r\n        shouldOpenConfirmationDialog: false,\r\n        shouldOpenPopupSelectEQASerumBottle: false,\r\n        errMessageBottle: \"\",\r\n        errMessageCode: \"\",\r\n        round: [],\r\n        result: null,\r\n        isView: false\r\n    };\r\n\r\n    handleChange = (event, source) => {\r\n        event.persist();\r\n        if (source === \"active\") {\r\n            this.setState({ hasErrorResult: false });\r\n        }\r\n        if (source === \"hasErrorSample\") {\r\n            this.setState({ hasErrorSample: false });\r\n        }\r\n        this.setState({\r\n            [event.target.name]: event.target.value\r\n        });\r\n    };\r\n\r\n    handleDelete = rowData => {\r\n        let eqaSampleBottles = this.state.eqaSampleBottles;\r\n        for (let index = 0; index < eqaSampleBottles.length; index++) {\r\n            const item = eqaSampleBottles[index]\r\n            if (\r\n                rowData &&\r\n                item &&\r\n                rowData.id === item.id\r\n            ) {\r\n                eqaSampleBottles.splice(index, 1)\r\n                this.setState({ eqaSampleBottles })\r\n                break\r\n            }\r\n        }\r\n\r\n    };\r\n    handleSelectEQARound = (item) => {\r\n        this.setState({ round: item });\r\n        let numberSampleList = [];\r\n        if (item != null && item.numberSampleList != null) {\r\n            for (let i = 0; i < item.numberSampleList; i++) {\r\n                numberSampleList.push({\r\n                    id: i + 1,\r\n                    name: i + 1\r\n                });\r\n            }\r\n            this.setState({ numberSampleList: numberSampleList });\r\n        } else {\r\n            this.setState({ numberSampleList: null });\r\n        }\r\n\r\n    }\r\n    handleFormSubmit = () => {\r\n        const { t, i18n } = this.props;\r\n        let { id, item } = this.state;\r\n        let checkNumberSample = false\r\n        if (item?.numberSample != null && item?.countSampleList != null) {\r\n            if (item.numberSample > item.countSampleList) {\r\n                checkNumberSample = true\r\n            }\r\n        }\r\n        console.log(checkNumberSample)\r\n        this.setState({ hasErrorResult: false, hasErrorSample: false, hasErrorPerson: false });\r\n        if ((typeof this.state.item.result == \"undefined\") || this.state.item.result === null) {\r\n            item[\"hasErrorResult\"] = true;\r\n            this.setState({ item: item });\r\n            return;\r\n        } else\r\n            if (typeof this.state.item.inactiveVirus == \"undefined\" || this.state.item.inactiveVirus === null) {\r\n                item[\"hasErrorVirus\"] = true;\r\n                this.setState({ item: item });\r\n                return;\r\n            } else {\r\n                if (item != null && item.eqaSampleBottles != null && item.eqaSampleBottles.length > 0) {\r\n                    if (typeof item.isManualSetCode != \"undefined\" && item.isManualSetCode) {\r\n                        checkCode(id, item.code).then(res => {\r\n                            if (res.data) {\r\n                                toast.warning(t(\"mess_code\"));\r\n                            } else {\r\n                                if (id) {\r\n                                    // this.setState({isView: true});\r\n\r\n                                    saveItem({\r\n                                        ...this.state.item\r\n                                    }).then((response) => {\r\n                                        if (response.data != null && response.status == 200) {\r\n                                            this.setState({ ...item })\r\n                                            toast.success(t('mess_edit'));\r\n                                        }\r\n                                        // this.props.handleOKEditClose();\r\n                                    }).catch(err => {\r\n                                        if (err.data == null) {\r\n                                            toast.warning(t(\"mess_edit_error\"));\r\n                                        }\r\n                                    })\r\n\r\n                                }\r\n\r\n                                else {\r\n                                    // this.setState({isView: true});\r\n                                    if (this.state.item)\r\n                                        if (checkNumberSample) {\r\n                                            saveItem({\r\n                                                ...this.state.item\r\n                                            }).then((response) => {\r\n                                                if (response.data != null && response.status == 200) {\r\n                                                    item.id = response.data.id\r\n                                                    this.setState({ ...item })\r\n                                                    toast.success(t('mess_add'));\r\n                                                }\r\n                                                // this.props.handleOKEditClose();\r\n                                            }).catch(err => {\r\n                                                if (err.data == null) {\r\n                                                    toast.warning(t(\"mess_add_error\"));\r\n                                                }\r\n                                            });\r\n                                        } else {\r\n                                            toast.warning(\"Số mẫu của kế hoạch này đã đủ\")\r\n                                        }\r\n\r\n                                }\r\n                            }\r\n                        })\r\n                    } else {\r\n                        if (id) {\r\n\r\n                            saveItem({\r\n                                ...this.state.item\r\n                            }).then((response) => {\r\n                                if (response.data != null && response.status == 200) {\r\n                                    this.setState({ ...item })\r\n                                    toast.success(t('mess_edit'));\r\n                                }\r\n                                // this.props.handleOKEditClose();\r\n                            }).catch(err => {\r\n                                if (err.data == null) {\r\n                                    toast.warning(t(\"mess_edit_error\"));\r\n                                }\r\n                            })\r\n\r\n\r\n                        }\r\n                        else {\r\n                            // this.setState({isView: true});\r\n                            if (checkNumberSample) {\r\n                                saveItem({\r\n                                    ...this.state.item\r\n                                }).then((response) => {\r\n                                    // this.props.handleOKEditClose();\r\n                                    if (response.data != null && response.status == 200) {\r\n                                        item.id = response.data.id\r\n                                        this.setState({ ...item })\r\n                                        toast.success(t('mess_add'));\r\n                                    }\r\n                                }).catch(err => {\r\n                                    if (err.data == null) {\r\n                                        toast.warning(t(\"mess_add_error\"));\r\n                                    }\r\n                                });\r\n                            } else {\r\n                                toast.warning(\"Số mẫu của kế hoạch này đã đủ\")\r\n                            }\r\n\r\n                        }\r\n                    }\r\n                } else {\r\n                    toast.warning(t(\"SampleManagement.eqaSampleBottlesisNull\"));\r\n                }\r\n            }\r\n\r\n    };\r\n\r\n    componentDidMount() {\r\n    }\r\n\r\n    componentWillMount() {\r\n        let { open, handleClose, item } = this.props;\r\n        this.setState({\r\n            item: item\r\n        });\r\n        let numberSampleList = [];\r\n        if (item && item.eqaSampleBottles && item.eqaSampleBottles.length > 0) {\r\n            item.eqaSampleBottles.sort((a, b) => (a.eQASerumBottle.code > b.eQASerumBottle.code) ? 1 : -1);\r\n        }\r\n        if (item.round != null && item.round.numberSampleList != null) {\r\n            for (let i = 0; i < item.round.numberSampleList; i++) {\r\n                numberSampleList.push({\r\n                    id: i + 1,\r\n                    name: i + 1\r\n                });\r\n            }\r\n            this.setState({ numberSampleList: numberSampleList });\r\n        } else {\r\n            this.setState({ numberSampleList: null });\r\n        }\r\n        this.setState({\r\n            ...item\r\n        });\r\n    }\r\n\r\n    handleThrombinAddedDateChange = (date) => {\r\n        this.setState({\r\n            thrombinAddedDate: date\r\n        });\r\n    };\r\n    handleRemoveFibrinDateChange = (date) => {\r\n        this.setState({\r\n            removeFibrinDate: date\r\n        });\r\n    };\r\n    handleCentrifugeDateChange = (date) => {\r\n        this.setState({\r\n            centrifugeDate: date\r\n        });\r\n    };\r\n    selectBottle = (bottles) => {\r\n        this.setState({ eqaSampleBottles: bottles }, function () {\r\n        });\r\n    }\r\n\r\n    handleClosePopupSelectEQASerumBottle = () => {\r\n        this.setState({ shouldOpenPopupSelectEQASerumBottle: false }, function () {\r\n        });\r\n    }\r\n\r\n    handleSelectEQASerumBottle = (item) => {\r\n        // item.sort((a, b) => (a.eQASerumBottle.code > b.eQASerumBottle.code) ? 1 : -1);\r\n        // this.setState({ eqaSampleBottles: item }, function () {\r\n        //     this.handleClosePopupSelectEQASerumBottle();\r\n        // });\r\n\r\n        let data = item.map(row => ({ ...row }));\r\n        this.setState({ eqaSampleBottles: data });\r\n        this.handleClosePopupSelectEQASerumBottle();\r\n    }\r\n\r\n    render() {\r\n        let { i18n, t, handleClose, open } = this.props\r\n        let {\r\n            id,\r\n            name,\r\n            code,\r\n            result,\r\n            round,\r\n            eqaSampleBottles,\r\n            additiveThrombin,\r\n            thrombinAddedDate,\r\n            inactiveVirus,\r\n            volumeAfterRemoveFibrin,\r\n            removeFibrinDate,\r\n            volumeAfterCentrifuge,\r\n            centrifugeDate,\r\n            volumeOfProclinAdded,\r\n            note, orderNumberSample,\r\n            numberSampleList,\r\n            numberSample,\r\n            hasErrorSample,\r\n            hasErrorResult,\r\n            isView,\r\n            shouldOpenPopupSelectEQASerumBottle\r\n        } = this.state;\r\n\r\n\r\n\r\n        return (\r\n            <Dialog open={open} PaperComponent={PaperComponent} maxWidth={'lg'} fullWidth={true}>\r\n                <DialogTitle style={{ cursor: 'move' }} id=\"draggable-dialog-title\">\r\n                    <span className=\"mb-20 styleColor\"> {(id ? t(\"update\") : t(\"Add\")) + \" \" + t(\"SampleManagement.sample-list.title\")} </span>\r\n                    <IconButton style={{ position: \"absolute\", right: \"10px\", top: \"10px\" }} onClick={() => handleClose()}><Icon color=\"error\"\r\n                        title={t(\"close\")}>\r\n                        close\r\n                    </Icon>\r\n                    </IconButton>\r\n                </DialogTitle>\r\n                <ValidatorForm ref=\"form\" onSubmit={this.handleFormSubmit} style={{\r\n                    overflowY: \"auto\",\r\n                    display: \"flex\",\r\n                    flexDirection: \"column\"\r\n                }}>\r\n                    <DialogContent dividers>\r\n                        <Grid item xs={12}>\r\n                            <TabsSample\r\n                                t={t} i18n={i18n}\r\n                                item={this.state.item}\r\n                            />\r\n                        </Grid>\r\n                    </DialogContent>\r\n\r\n                    <DialogActions spacing={4} className=\"flex flex-end flex-middle\">\r\n                        <Button\r\n                            variant=\"contained\"\r\n                            className=\"mr-16\"\r\n                            color=\"secondary\"\r\n                            type=\"button\" onClick={() => handleClose()}> {t('Cancel')}</Button>\r\n                        <Button\r\n                            disabled={isView}\r\n                            variant=\"contained\"\r\n                            color=\"primary\"\r\n                            className=\" mr-16 align-bottom\"\r\n                            type=\"submit\">\r\n                            {t('Save')}\r\n                        </Button>\r\n                    </DialogActions>\r\n                </ValidatorForm>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\nexport default EQASampleEditorDialog;\r\n"]},"metadata":{},"sourceType":"module"}