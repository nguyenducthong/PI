{"ast":null,"code":"/*\n * Copyright 2016 Red Hat, Inc. and/or its affiliates\n * and other contributors as indicated by the @author tags.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n(function (root, factory) {\n  if (typeof exports === 'object') {\n    if (typeof module === 'object') {\n      module.exports = factory(require(\"js-sha256\"), require(\"base64-js\"));\n    } else {\n      exports[\"keycloak\"] = factory(require(\"js-sha256\"), require(\"base64-js\"));\n    }\n  } else {\n    /**\n    * [js-sha256]{@link https://github.com/emn178/js-sha256}\n    *\n    * @version 0.9.0\n    * @author Chen, Yi-Cyuan [emn178@gmail.com]\n    * @copyright Chen, Yi-Cyuan 2014-2017\n    * @license MIT\n    */\n    !function () {\n      \"use strict\";\n\n      function t(t, i) {\n        i ? (d[0] = d[16] = d[1] = d[2] = d[3] = d[4] = d[5] = d[6] = d[7] = d[8] = d[9] = d[10] = d[11] = d[12] = d[13] = d[14] = d[15] = 0, this.blocks = d) : this.blocks = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], t ? (this.h0 = 3238371032, this.h1 = 914150663, this.h2 = 812702999, this.h3 = 4144912697, this.h4 = 4290775857, this.h5 = 1750603025, this.h6 = 1694076839, this.h7 = 3204075428) : (this.h0 = 1779033703, this.h1 = 3144134277, this.h2 = 1013904242, this.h3 = 2773480762, this.h4 = 1359893119, this.h5 = 2600822924, this.h6 = 528734635, this.h7 = 1541459225), this.block = this.start = this.bytes = this.hBytes = 0, this.finalized = this.hashed = !1, this.first = !0, this.is224 = t;\n      }\n\n      function i(i, r, s) {\n        var e,\n            n = typeof i;\n\n        if (\"string\" === n) {\n          var o,\n              a = [],\n              u = i.length,\n              c = 0;\n\n          for (e = 0; e < u; ++e) {\n            (o = i.charCodeAt(e)) < 128 ? a[c++] = o : o < 2048 ? (a[c++] = 192 | o >> 6, a[c++] = 128 | 63 & o) : o < 55296 || o >= 57344 ? (a[c++] = 224 | o >> 12, a[c++] = 128 | o >> 6 & 63, a[c++] = 128 | 63 & o) : (o = 65536 + ((1023 & o) << 10 | 1023 & i.charCodeAt(++e)), a[c++] = 240 | o >> 18, a[c++] = 128 | o >> 12 & 63, a[c++] = 128 | o >> 6 & 63, a[c++] = 128 | 63 & o);\n          }\n\n          i = a;\n        } else {\n          if (\"object\" !== n) throw new Error(h);\n          if (null === i) throw new Error(h);\n          if (f && i.constructor === ArrayBuffer) i = new Uint8Array(i);else if (!(Array.isArray(i) || f && ArrayBuffer.isView(i))) throw new Error(h);\n        }\n\n        i.length > 64 && (i = new t(r, !0).update(i).array());\n        var y = [],\n            p = [];\n\n        for (e = 0; e < 64; ++e) {\n          var l = i[e] || 0;\n          y[e] = 92 ^ l, p[e] = 54 ^ l;\n        }\n\n        t.call(this, r, s), this.update(p), this.oKeyPad = y, this.inner = !0, this.sharedMemory = s;\n      }\n\n      var h = \"input is invalid type\",\n          r = \"object\" == typeof window,\n          s = r ? window : {};\n      s.JS_SHA256_NO_WINDOW && (r = !1);\n      var e = !r && \"object\" == typeof self,\n          n = !s.JS_SHA256_NO_NODE_JS && \"object\" == typeof process && process.versions && process.versions.node;\n      n ? s = global : e && (s = self);\n      var o = !s.JS_SHA256_NO_COMMON_JS && \"object\" == typeof module && module.exports,\n          a = \"function\" == typeof define && define.amd,\n          f = !s.JS_SHA256_NO_ARRAY_BUFFER && \"undefined\" != typeof ArrayBuffer,\n          u = \"0123456789abcdef\".split(\"\"),\n          c = [-2147483648, 8388608, 32768, 128],\n          y = [24, 16, 8, 0],\n          p = [1116352408, 1899447441, 3049323471, 3921009573, 961987163, 1508970993, 2453635748, 2870763221, 3624381080, 310598401, 607225278, 1426881987, 1925078388, 2162078206, 2614888103, 3248222580, 3835390401, 4022224774, 264347078, 604807628, 770255983, 1249150122, 1555081692, 1996064986, 2554220882, 2821834349, 2952996808, 3210313671, 3336571891, 3584528711, 113926993, 338241895, 666307205, 773529912, 1294757372, 1396182291, 1695183700, 1986661051, 2177026350, 2456956037, 2730485921, 2820302411, 3259730800, 3345764771, 3516065817, 3600352804, 4094571909, 275423344, 430227734, 506948616, 659060556, 883997877, 958139571, 1322822218, 1537002063, 1747873779, 1955562222, 2024104815, 2227730452, 2361852424, 2428436474, 2756734187, 3204031479, 3329325298],\n          l = [\"hex\", \"array\", \"digest\", \"arrayBuffer\"],\n          d = [];\n      !s.JS_SHA256_NO_NODE_JS && Array.isArray || (Array.isArray = function (t) {\n        return \"[object Array]\" === Object.prototype.toString.call(t);\n      }), !f || !s.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW && ArrayBuffer.isView || (ArrayBuffer.isView = function (t) {\n        return \"object\" == typeof t && t.buffer && t.buffer.constructor === ArrayBuffer;\n      });\n\n      var A = function A(i, h) {\n        return function (r) {\n          return new t(h, !0).update(r)[i]();\n        };\n      },\n          w = function w(i) {\n        var h = A(\"hex\", i);\n        n && (h = b(h, i)), h.create = function () {\n          return new t(i);\n        }, h.update = function (t) {\n          return h.create().update(t);\n        };\n\n        for (var r = 0; r < l.length; ++r) {\n          var s = l[r];\n          h[s] = A(s, i);\n        }\n\n        return h;\n      },\n          b = function b(t, i) {\n        var r = eval(\"require('crypto')\"),\n            s = eval(\"require('buffer').Buffer\"),\n            e = i ? \"sha224\" : \"sha256\",\n            n = function n(i) {\n          if (\"string\" == typeof i) return r.createHash(e).update(i, \"utf8\").digest(\"hex\");\n          if (null === i || void 0 === i) throw new Error(h);\n          return i.constructor === ArrayBuffer && (i = new Uint8Array(i)), Array.isArray(i) || ArrayBuffer.isView(i) || i.constructor === s ? r.createHash(e).update(new s(i)).digest(\"hex\") : t(i);\n        };\n\n        return n;\n      },\n          v = function v(t, h) {\n        return function (r, s) {\n          return new i(r, h, !0).update(s)[t]();\n        };\n      },\n          _ = function _(t) {\n        var h = v(\"hex\", t);\n        h.create = function (h) {\n          return new i(h, t);\n        }, h.update = function (t, i) {\n          return h.create(t).update(i);\n        };\n\n        for (var r = 0; r < l.length; ++r) {\n          var s = l[r];\n          h[s] = v(s, t);\n        }\n\n        return h;\n      };\n\n      t.prototype.update = function (t) {\n        if (!this.finalized) {\n          var i,\n              r = typeof t;\n\n          if (\"string\" !== r) {\n            if (\"object\" !== r) throw new Error(h);\n            if (null === t) throw new Error(h);\n            if (f && t.constructor === ArrayBuffer) t = new Uint8Array(t);else if (!(Array.isArray(t) || f && ArrayBuffer.isView(t))) throw new Error(h);\n            i = !0;\n          }\n\n          for (var s, e, n = 0, o = t.length, a = this.blocks; n < o;) {\n            if (this.hashed && (this.hashed = !1, a[0] = this.block, a[16] = a[1] = a[2] = a[3] = a[4] = a[5] = a[6] = a[7] = a[8] = a[9] = a[10] = a[11] = a[12] = a[13] = a[14] = a[15] = 0), i) for (e = this.start; n < o && e < 64; ++n) {\n              a[e >> 2] |= t[n] << y[3 & e++];\n            } else for (e = this.start; n < o && e < 64; ++n) {\n              (s = t.charCodeAt(n)) < 128 ? a[e >> 2] |= s << y[3 & e++] : s < 2048 ? (a[e >> 2] |= (192 | s >> 6) << y[3 & e++], a[e >> 2] |= (128 | 63 & s) << y[3 & e++]) : s < 55296 || s >= 57344 ? (a[e >> 2] |= (224 | s >> 12) << y[3 & e++], a[e >> 2] |= (128 | s >> 6 & 63) << y[3 & e++], a[e >> 2] |= (128 | 63 & s) << y[3 & e++]) : (s = 65536 + ((1023 & s) << 10 | 1023 & t.charCodeAt(++n)), a[e >> 2] |= (240 | s >> 18) << y[3 & e++], a[e >> 2] |= (128 | s >> 12 & 63) << y[3 & e++], a[e >> 2] |= (128 | s >> 6 & 63) << y[3 & e++], a[e >> 2] |= (128 | 63 & s) << y[3 & e++]);\n            }\n            this.lastByteIndex = e, this.bytes += e - this.start, e >= 64 ? (this.block = a[16], this.start = e - 64, this.hash(), this.hashed = !0) : this.start = e;\n          }\n\n          return this.bytes > 4294967295 && (this.hBytes += this.bytes / 4294967296 << 0, this.bytes = this.bytes % 4294967296), this;\n        }\n      }, t.prototype.finalize = function () {\n        if (!this.finalized) {\n          this.finalized = !0;\n          var t = this.blocks,\n              i = this.lastByteIndex;\n          t[16] = this.block, t[i >> 2] |= c[3 & i], this.block = t[16], i >= 56 && (this.hashed || this.hash(), t[0] = this.block, t[16] = t[1] = t[2] = t[3] = t[4] = t[5] = t[6] = t[7] = t[8] = t[9] = t[10] = t[11] = t[12] = t[13] = t[14] = t[15] = 0), t[14] = this.hBytes << 3 | this.bytes >>> 29, t[15] = this.bytes << 3, this.hash();\n        }\n      }, t.prototype.hash = function () {\n        var t,\n            i,\n            h,\n            r,\n            s,\n            e,\n            n,\n            o,\n            a,\n            f = this.h0,\n            u = this.h1,\n            c = this.h2,\n            y = this.h3,\n            l = this.h4,\n            d = this.h5,\n            A = this.h6,\n            w = this.h7,\n            b = this.blocks;\n\n        for (t = 16; t < 64; ++t) {\n          i = ((s = b[t - 15]) >>> 7 | s << 25) ^ (s >>> 18 | s << 14) ^ s >>> 3, h = ((s = b[t - 2]) >>> 17 | s << 15) ^ (s >>> 19 | s << 13) ^ s >>> 10, b[t] = b[t - 16] + i + b[t - 7] + h << 0;\n        }\n\n        for (a = u & c, t = 0; t < 64; t += 4) {\n          this.first ? (this.is224 ? (e = 300032, w = (s = b[0] - 1413257819) - 150054599 << 0, y = s + 24177077 << 0) : (e = 704751109, w = (s = b[0] - 210244248) - 1521486534 << 0, y = s + 143694565 << 0), this.first = !1) : (i = (f >>> 2 | f << 30) ^ (f >>> 13 | f << 19) ^ (f >>> 22 | f << 10), r = (e = f & u) ^ f & c ^ a, w = y + (s = w + (h = (l >>> 6 | l << 26) ^ (l >>> 11 | l << 21) ^ (l >>> 25 | l << 7)) + (l & d ^ ~l & A) + p[t] + b[t]) << 0, y = s + (i + r) << 0), i = (y >>> 2 | y << 30) ^ (y >>> 13 | y << 19) ^ (y >>> 22 | y << 10), r = (n = y & f) ^ y & u ^ e, A = c + (s = A + (h = (w >>> 6 | w << 26) ^ (w >>> 11 | w << 21) ^ (w >>> 25 | w << 7)) + (w & l ^ ~w & d) + p[t + 1] + b[t + 1]) << 0, i = ((c = s + (i + r) << 0) >>> 2 | c << 30) ^ (c >>> 13 | c << 19) ^ (c >>> 22 | c << 10), r = (o = c & y) ^ c & f ^ n, d = u + (s = d + (h = (A >>> 6 | A << 26) ^ (A >>> 11 | A << 21) ^ (A >>> 25 | A << 7)) + (A & w ^ ~A & l) + p[t + 2] + b[t + 2]) << 0, i = ((u = s + (i + r) << 0) >>> 2 | u << 30) ^ (u >>> 13 | u << 19) ^ (u >>> 22 | u << 10), r = (a = u & c) ^ u & y ^ o, l = f + (s = l + (h = (d >>> 6 | d << 26) ^ (d >>> 11 | d << 21) ^ (d >>> 25 | d << 7)) + (d & A ^ ~d & w) + p[t + 3] + b[t + 3]) << 0, f = s + (i + r) << 0;\n        }\n\n        this.h0 = this.h0 + f << 0, this.h1 = this.h1 + u << 0, this.h2 = this.h2 + c << 0, this.h3 = this.h3 + y << 0, this.h4 = this.h4 + l << 0, this.h5 = this.h5 + d << 0, this.h6 = this.h6 + A << 0, this.h7 = this.h7 + w << 0;\n      }, t.prototype.hex = function () {\n        this.finalize();\n        var t = this.h0,\n            i = this.h1,\n            h = this.h2,\n            r = this.h3,\n            s = this.h4,\n            e = this.h5,\n            n = this.h6,\n            o = this.h7,\n            a = u[t >> 28 & 15] + u[t >> 24 & 15] + u[t >> 20 & 15] + u[t >> 16 & 15] + u[t >> 12 & 15] + u[t >> 8 & 15] + u[t >> 4 & 15] + u[15 & t] + u[i >> 28 & 15] + u[i >> 24 & 15] + u[i >> 20 & 15] + u[i >> 16 & 15] + u[i >> 12 & 15] + u[i >> 8 & 15] + u[i >> 4 & 15] + u[15 & i] + u[h >> 28 & 15] + u[h >> 24 & 15] + u[h >> 20 & 15] + u[h >> 16 & 15] + u[h >> 12 & 15] + u[h >> 8 & 15] + u[h >> 4 & 15] + u[15 & h] + u[r >> 28 & 15] + u[r >> 24 & 15] + u[r >> 20 & 15] + u[r >> 16 & 15] + u[r >> 12 & 15] + u[r >> 8 & 15] + u[r >> 4 & 15] + u[15 & r] + u[s >> 28 & 15] + u[s >> 24 & 15] + u[s >> 20 & 15] + u[s >> 16 & 15] + u[s >> 12 & 15] + u[s >> 8 & 15] + u[s >> 4 & 15] + u[15 & s] + u[e >> 28 & 15] + u[e >> 24 & 15] + u[e >> 20 & 15] + u[e >> 16 & 15] + u[e >> 12 & 15] + u[e >> 8 & 15] + u[e >> 4 & 15] + u[15 & e] + u[n >> 28 & 15] + u[n >> 24 & 15] + u[n >> 20 & 15] + u[n >> 16 & 15] + u[n >> 12 & 15] + u[n >> 8 & 15] + u[n >> 4 & 15] + u[15 & n];\n        return this.is224 || (a += u[o >> 28 & 15] + u[o >> 24 & 15] + u[o >> 20 & 15] + u[o >> 16 & 15] + u[o >> 12 & 15] + u[o >> 8 & 15] + u[o >> 4 & 15] + u[15 & o]), a;\n      }, t.prototype.toString = t.prototype.hex, t.prototype.digest = function () {\n        this.finalize();\n        var t = this.h0,\n            i = this.h1,\n            h = this.h2,\n            r = this.h3,\n            s = this.h4,\n            e = this.h5,\n            n = this.h6,\n            o = this.h7,\n            a = [t >> 24 & 255, t >> 16 & 255, t >> 8 & 255, 255 & t, i >> 24 & 255, i >> 16 & 255, i >> 8 & 255, 255 & i, h >> 24 & 255, h >> 16 & 255, h >> 8 & 255, 255 & h, r >> 24 & 255, r >> 16 & 255, r >> 8 & 255, 255 & r, s >> 24 & 255, s >> 16 & 255, s >> 8 & 255, 255 & s, e >> 24 & 255, e >> 16 & 255, e >> 8 & 255, 255 & e, n >> 24 & 255, n >> 16 & 255, n >> 8 & 255, 255 & n];\n        return this.is224 || a.push(o >> 24 & 255, o >> 16 & 255, o >> 8 & 255, 255 & o), a;\n      }, t.prototype.array = t.prototype.digest, t.prototype.arrayBuffer = function () {\n        this.finalize();\n        var t = new ArrayBuffer(this.is224 ? 28 : 32),\n            i = new DataView(t);\n        return i.setUint32(0, this.h0), i.setUint32(4, this.h1), i.setUint32(8, this.h2), i.setUint32(12, this.h3), i.setUint32(16, this.h4), i.setUint32(20, this.h5), i.setUint32(24, this.h6), this.is224 || i.setUint32(28, this.h7), t;\n      }, i.prototype = new t(), i.prototype.finalize = function () {\n        if (t.prototype.finalize.call(this), this.inner) {\n          this.inner = !1;\n          var i = this.array();\n          t.call(this, this.is224, this.sharedMemory), this.update(this.oKeyPad), this.update(i), t.prototype.finalize.call(this);\n        }\n      };\n      var B = w();\n      B.sha256 = B, B.sha224 = w(!0), B.sha256.hmac = _(), B.sha224.hmac = _(!0), o ? module.exports = B : (s.sha256 = B.sha256, s.sha224 = B.sha224, a && define(function () {\n        return B;\n      }));\n    }();\n    /**\n     * [base64-js]{@link https://github.com/beatgammit/base64-js}\n     *\n     * @version v1.3.0 \n     * @author Kirill, Fomichev\n     * @copyright Kirill, Fomichev 2014\n     * @license MIT\n     */\n\n    (function (r) {\n      if (typeof exports === \"object\" && typeof module !== \"undefined\") {\n        module.exports = r();\n      } else if (typeof define === \"function\" && define.amd) {\n        define([], r);\n      } else {\n        var e;\n\n        if (typeof window !== \"undefined\") {\n          e = window;\n        } else if (typeof global !== \"undefined\") {\n          e = global;\n        } else if (typeof self !== \"undefined\") {\n          e = self;\n        } else {\n          e = this;\n        }\n\n        e.base64js = r();\n      }\n    })(function () {\n      var r, e, n;\n      return function () {\n        function r(e, n, t) {\n          function o(f, i) {\n            if (!n[f]) {\n              if (!e[f]) {\n                var u = \"function\" == typeof require && require;\n                if (!i && u) return u(f, !0);\n                if (a) return a(f, !0);\n                var v = new Error(\"Cannot find module '\" + f + \"'\");\n                throw v.code = \"MODULE_NOT_FOUND\", v;\n              }\n\n              var d = n[f] = {\n                exports: {}\n              };\n              e[f][0].call(d.exports, function (r) {\n                var n = e[f][1][r];\n                return o(n || r);\n              }, d, d.exports, r, e, n, t);\n            }\n\n            return n[f].exports;\n          }\n\n          for (var a = \"function\" == typeof require && require, f = 0; f < t.length; f++) {\n            o(t[f]);\n          }\n\n          return o;\n        }\n\n        return r;\n      }()({\n        \"/\": [function (r, e, n) {\n          \"use strict\";\n\n          n.byteLength = d;\n          n.toByteArray = h;\n          n.fromByteArray = p;\n          var t = [];\n          var o = [];\n          var a = typeof Uint8Array !== \"undefined\" ? Uint8Array : Array;\n          var f = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n          for (var i = 0, u = f.length; i < u; ++i) {\n            t[i] = f[i];\n            o[f.charCodeAt(i)] = i;\n          }\n\n          o[\"-\".charCodeAt(0)] = 62;\n          o[\"_\".charCodeAt(0)] = 63;\n\n          function v(r) {\n            var e = r.length;\n\n            if (e % 4 > 0) {\n              throw new Error(\"Invalid string. Length must be a multiple of 4\");\n            }\n\n            var n = r.indexOf(\"=\");\n            if (n === -1) n = e;\n            var t = n === e ? 0 : 4 - n % 4;\n            return [n, t];\n          }\n\n          function d(r) {\n            var e = v(r);\n            var n = e[0];\n            var t = e[1];\n            return (n + t) * 3 / 4 - t;\n          }\n\n          function c(r, e, n) {\n            return (e + n) * 3 / 4 - n;\n          }\n\n          function h(r) {\n            var e;\n            var n = v(r);\n            var t = n[0];\n            var f = n[1];\n            var i = new a(c(r, t, f));\n            var u = 0;\n            var d = f > 0 ? t - 4 : t;\n\n            for (var h = 0; h < d; h += 4) {\n              e = o[r.charCodeAt(h)] << 18 | o[r.charCodeAt(h + 1)] << 12 | o[r.charCodeAt(h + 2)] << 6 | o[r.charCodeAt(h + 3)];\n              i[u++] = e >> 16 & 255;\n              i[u++] = e >> 8 & 255;\n              i[u++] = e & 255;\n            }\n\n            if (f === 2) {\n              e = o[r.charCodeAt(h)] << 2 | o[r.charCodeAt(h + 1)] >> 4;\n              i[u++] = e & 255;\n            }\n\n            if (f === 1) {\n              e = o[r.charCodeAt(h)] << 10 | o[r.charCodeAt(h + 1)] << 4 | o[r.charCodeAt(h + 2)] >> 2;\n              i[u++] = e >> 8 & 255;\n              i[u++] = e & 255;\n            }\n\n            return i;\n          }\n\n          function s(r) {\n            return t[r >> 18 & 63] + t[r >> 12 & 63] + t[r >> 6 & 63] + t[r & 63];\n          }\n\n          function l(r, e, n) {\n            var t;\n            var o = [];\n\n            for (var a = e; a < n; a += 3) {\n              t = (r[a] << 16 & 16711680) + (r[a + 1] << 8 & 65280) + (r[a + 2] & 255);\n              o.push(s(t));\n            }\n\n            return o.join(\"\");\n          }\n\n          function p(r) {\n            var e;\n            var n = r.length;\n            var o = n % 3;\n            var a = [];\n            var f = 16383;\n\n            for (var i = 0, u = n - o; i < u; i += f) {\n              a.push(l(r, i, i + f > u ? u : i + f));\n            }\n\n            if (o === 1) {\n              e = r[n - 1];\n              a.push(t[e >> 2] + t[e << 4 & 63] + \"==\");\n            } else if (o === 2) {\n              e = (r[n - 2] << 8) + r[n - 1];\n              a.push(t[e >> 10] + t[e >> 4 & 63] + t[e << 2 & 63] + \"=\");\n            }\n\n            return a.join(\"\");\n          }\n        }, {}]\n      }, {}, [])(\"/\");\n    });\n    /**\n     * [promise-polyfill]{@link https://github.com/taylorhakes/promise-polyfill}\n     *\n     * @version v8.1.3 \n     * @author Hakes, Taylor\n     * @copyright Hakes, Taylor 2014\n     * @license MIT\n     */\n\n\n    !function (e, n) {\n      \"object\" == typeof exports && \"undefined\" != typeof module ? n() : \"function\" == typeof define && define.amd ? define(n) : n();\n    }(0, function () {\n      \"use strict\";\n\n      function e(e) {\n        var n = this.constructor;\n        return this.then(function (t) {\n          return n.resolve(e()).then(function () {\n            return t;\n          });\n        }, function (t) {\n          return n.resolve(e()).then(function () {\n            return n.reject(t);\n          });\n        });\n      }\n\n      function n(e) {\n        return !(!e || \"undefined\" == typeof e.length);\n      }\n\n      function t() {}\n\n      function o(e) {\n        if (!(this instanceof o)) throw new TypeError(\"Promises must be constructed via new\");\n        if (\"function\" != typeof e) throw new TypeError(\"not a function\");\n        this._state = 0, this._handled = !1, this._value = undefined, this._deferreds = [], c(e, this);\n      }\n\n      function r(e, n) {\n        for (; 3 === e._state;) {\n          e = e._value;\n        }\n\n        0 !== e._state ? (e._handled = !0, o._immediateFn(function () {\n          var t = 1 === e._state ? n.onFulfilled : n.onRejected;\n\n          if (null !== t) {\n            var o;\n\n            try {\n              o = t(e._value);\n            } catch (r) {\n              return void f(n.promise, r);\n            }\n\n            i(n.promise, o);\n          } else (1 === e._state ? i : f)(n.promise, e._value);\n        })) : e._deferreds.push(n);\n      }\n\n      function i(e, n) {\n        try {\n          if (n === e) throw new TypeError(\"A promise cannot be resolved with itself.\");\n\n          if (n && (\"object\" == typeof n || \"function\" == typeof n)) {\n            var t = n.then;\n            if (n instanceof o) return e._state = 3, e._value = n, void u(e);\n            if (\"function\" == typeof t) return void c(function (e, n) {\n              return function () {\n                e.apply(n, arguments);\n              };\n            }(t, n), e);\n          }\n\n          e._state = 1, e._value = n, u(e);\n        } catch (r) {\n          f(e, r);\n        }\n      }\n\n      function f(e, n) {\n        e._state = 2, e._value = n, u(e);\n      }\n\n      function u(e) {\n        2 === e._state && 0 === e._deferreds.length && o._immediateFn(function () {\n          e._handled || o._unhandledRejectionFn(e._value);\n        });\n\n        for (var n = 0, t = e._deferreds.length; t > n; n++) {\n          r(e, e._deferreds[n]);\n        }\n\n        e._deferreds = null;\n      }\n\n      function c(e, n) {\n        var t = !1;\n\n        try {\n          e(function (e) {\n            t || (t = !0, i(n, e));\n          }, function (e) {\n            t || (t = !0, f(n, e));\n          });\n        } catch (o) {\n          if (t) return;\n          t = !0, f(n, o);\n        }\n      }\n\n      var a = setTimeout;\n      o.prototype[\"catch\"] = function (e) {\n        return this.then(null, e);\n      }, o.prototype.then = function (e, n) {\n        var o = new this.constructor(t);\n        return r(this, new function (e, n, t) {\n          this.onFulfilled = \"function\" == typeof e ? e : null, this.onRejected = \"function\" == typeof n ? n : null, this.promise = t;\n        }(e, n, o)), o;\n      }, o.prototype[\"finally\"] = e, o.all = function (e) {\n        return new o(function (t, o) {\n          function r(e, n) {\n            try {\n              if (n && (\"object\" == typeof n || \"function\" == typeof n)) {\n                var u = n.then;\n                if (\"function\" == typeof u) return void u.call(n, function (n) {\n                  r(e, n);\n                }, o);\n              }\n\n              i[e] = n, 0 == --f && t(i);\n            } catch (c) {\n              o(c);\n            }\n          }\n\n          if (!n(e)) return o(new TypeError(\"Promise.all accepts an array\"));\n          var i = Array.prototype.slice.call(e);\n          if (0 === i.length) return t([]);\n\n          for (var f = i.length, u = 0; i.length > u; u++) {\n            r(u, i[u]);\n          }\n        });\n      }, o.resolve = function (e) {\n        return e && \"object\" == typeof e && e.constructor === o ? e : new o(function (n) {\n          n(e);\n        });\n      }, o.reject = function (e) {\n        return new o(function (n, t) {\n          t(e);\n        });\n      }, o.race = function (e) {\n        return new o(function (t, r) {\n          if (!n(e)) return r(new TypeError(\"Promise.race accepts an array\"));\n\n          for (var i = 0, f = e.length; f > i; i++) {\n            o.resolve(e[i]).then(t, r);\n          }\n        });\n      }, o._immediateFn = \"function\" == typeof setImmediate && function (e) {\n        setImmediate(e);\n      } || function (e) {\n        a(e, 0);\n      }, o._unhandledRejectionFn = function (e) {\n        void 0 !== console && console && console.warn(\"Possible Unhandled Promise Rejection:\", e);\n      };\n\n      var l = function () {\n        if (\"undefined\" != typeof self) return self;\n        if (\"undefined\" != typeof window) return window;\n        if (\"undefined\" != typeof global) return global;\n        throw Error(\"unable to locate global object\");\n      }();\n\n      \"Promise\" in l ? l.Promise.prototype[\"finally\"] || (l.Promise.prototype[\"finally\"] = e) : l.Promise = o;\n    });\n    var Keycloak = factory(root[\"sha256\"], root[\"base64js\"]);\n    root[\"Keycloak\"] = Keycloak;\n\n    if (typeof define === \"function\" && define.amd) {\n      define(\"keycloak\", [], function () {\n        return Keycloak;\n      });\n    }\n  }\n})(window, function (sha256_imported, base64js_imported) {\n  if (typeof Promise === 'undefined') {\n    throw Error('Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.');\n  }\n\n  var loggedPromiseDeprecation = false;\n\n  function logPromiseDeprecation() {\n    if (!loggedPromiseDeprecation) {\n      loggedPromiseDeprecation = true;\n      console.warn('[KEYCLOAK] Usage of legacy style promise methods such as `.error()` and `.success()` has been deprecated and support will be removed in future versions. Use standard style promise methods such as `.then() and `.catch()` instead.');\n    }\n  }\n\n  function toKeycloakPromise(promise) {\n    promise.__proto__ = KeycloakPromise.prototype;\n    return promise;\n  }\n\n  function KeycloakPromise(executor) {\n    return toKeycloakPromise(new Promise(executor));\n  }\n\n  KeycloakPromise.prototype = Object.create(Promise.prototype);\n  KeycloakPromise.prototype.constructor = KeycloakPromise;\n\n  KeycloakPromise.prototype.success = function (callback) {\n    logPromiseDeprecation();\n    var promise = this.then(function handleSuccess(value) {\n      callback(value);\n    });\n    return toKeycloakPromise(promise);\n  };\n\n  KeycloakPromise.prototype.error = function (callback) {\n    logPromiseDeprecation();\n    var promise = this.catch(function handleError(error) {\n      callback(error);\n    });\n    return toKeycloakPromise(promise);\n  };\n\n  function Keycloak(config) {\n    if (!(this instanceof Keycloak)) {\n      return new Keycloak(config);\n    }\n\n    var kc = this;\n    var adapter;\n    var refreshQueue = [];\n    var callbackStorage;\n    var loginIframe = {\n      enable: true,\n      callbackList: [],\n      interval: 5\n    };\n    var scripts = document.getElementsByTagName('script');\n\n    for (var i = 0; i < scripts.length; i++) {\n      if ((scripts[i].src.indexOf('keycloak.js') !== -1 || scripts[i].src.indexOf('keycloak.min.js') !== -1) && scripts[i].src.indexOf('version=') !== -1) {\n        kc.iframeVersion = scripts[i].src.substring(scripts[i].src.indexOf('version=') + 8).split('&')[0];\n      }\n    }\n\n    var useNonce = true;\n    var logInfo = createLogger(console.info);\n    var logWarn = createLogger(console.warn);\n\n    kc.init = function (initOptions) {\n      kc.authenticated = false;\n      callbackStorage = createCallbackStorage();\n      var adapters = ['default', 'cordova', 'cordova-native'];\n\n      if (initOptions && adapters.indexOf(initOptions.adapter) > -1) {\n        adapter = loadAdapter(initOptions.adapter);\n      } else if (initOptions && typeof initOptions.adapter === \"object\") {\n        adapter = initOptions.adapter;\n      } else {\n        if (window.Cordova || window.cordova) {\n          adapter = loadAdapter('cordova');\n        } else {\n          adapter = loadAdapter();\n        }\n      }\n\n      if (initOptions) {\n        if (typeof initOptions.useNonce !== 'undefined') {\n          useNonce = initOptions.useNonce;\n        }\n\n        if (typeof initOptions.checkLoginIframe !== 'undefined') {\n          loginIframe.enable = initOptions.checkLoginIframe;\n        }\n\n        if (initOptions.checkLoginIframeInterval) {\n          loginIframe.interval = initOptions.checkLoginIframeInterval;\n        }\n\n        if (initOptions.onLoad === 'login-required') {\n          kc.loginRequired = true;\n        }\n\n        if (initOptions.responseMode) {\n          if (initOptions.responseMode === 'query' || initOptions.responseMode === 'fragment') {\n            kc.responseMode = initOptions.responseMode;\n          } else {\n            throw 'Invalid value for responseMode';\n          }\n        }\n\n        if (initOptions.flow) {\n          switch (initOptions.flow) {\n            case 'standard':\n              kc.responseType = 'code';\n              break;\n\n            case 'implicit':\n              kc.responseType = 'id_token token';\n              break;\n\n            case 'hybrid':\n              kc.responseType = 'code id_token token';\n              break;\n\n            default:\n              throw 'Invalid value for flow';\n          }\n\n          kc.flow = initOptions.flow;\n        }\n\n        if (initOptions.timeSkew != null) {\n          kc.timeSkew = initOptions.timeSkew;\n        }\n\n        if (initOptions.redirectUri) {\n          kc.redirectUri = initOptions.redirectUri;\n        }\n\n        if (initOptions.silentCheckSsoRedirectUri) {\n          kc.silentCheckSsoRedirectUri = initOptions.silentCheckSsoRedirectUri;\n        }\n\n        if (initOptions.pkceMethod) {\n          if (initOptions.pkceMethod !== \"S256\") {\n            throw 'Invalid value for pkceMethod';\n          }\n\n          kc.pkceMethod = initOptions.pkceMethod;\n        }\n\n        if (typeof initOptions.enableLogging === 'boolean') {\n          kc.enableLogging = initOptions.enableLogging;\n        } else {\n          kc.enableLogging = false;\n        }\n      }\n\n      if (!kc.responseMode) {\n        kc.responseMode = 'fragment';\n      }\n\n      if (!kc.responseType) {\n        kc.responseType = 'code';\n        kc.flow = 'standard';\n      }\n\n      var promise = createPromise();\n      var initPromise = createPromise();\n      initPromise.promise.then(function () {\n        kc.onReady && kc.onReady(kc.authenticated);\n        promise.setSuccess(kc.authenticated);\n      }).catch(function (errorData) {\n        promise.setError(errorData);\n      });\n      var configPromise = loadConfig(config);\n\n      function onLoad() {\n        var doLogin = function doLogin(prompt) {\n          if (!prompt) {\n            options.prompt = 'none';\n          }\n\n          kc.login(options).then(function () {\n            initPromise.setSuccess();\n          }).catch(function () {\n            initPromise.setError();\n          });\n        };\n\n        var checkSsoSilently = function checkSsoSilently() {\n          var ifrm = document.createElement(\"iframe\");\n          var src = kc.createLoginUrl({\n            prompt: 'none',\n            redirectUri: kc.silentCheckSsoRedirectUri\n          });\n          ifrm.setAttribute(\"src\", src);\n          ifrm.setAttribute(\"title\", \"keycloak-silent-check-sso\");\n          ifrm.style.display = \"none\";\n          document.body.appendChild(ifrm);\n\n          var messageCallback = function messageCallback(event) {\n            if (event.origin !== window.location.origin || ifrm.contentWindow !== event.source) {\n              return;\n            }\n\n            var oauth = parseCallback(event.data);\n            processCallback(oauth, initPromise);\n            document.body.removeChild(ifrm);\n            window.removeEventListener(\"message\", messageCallback);\n          };\n\n          window.addEventListener(\"message\", messageCallback);\n        };\n\n        var options = {};\n\n        switch (initOptions.onLoad) {\n          case 'check-sso':\n            if (loginIframe.enable) {\n              setupCheckLoginIframe().then(function () {\n                checkLoginIframe().then(function (unchanged) {\n                  if (!unchanged) {\n                    kc.silentCheckSsoRedirectUri ? checkSsoSilently() : doLogin(false);\n                  } else {\n                    initPromise.setSuccess();\n                  }\n                }).catch(function () {\n                  initPromise.setError();\n                });\n              });\n            } else {\n              kc.silentCheckSsoRedirectUri ? checkSsoSilently() : doLogin(false);\n            }\n\n            break;\n\n          case 'login-required':\n            doLogin(true);\n            break;\n\n          default:\n            throw 'Invalid value for onLoad';\n        }\n      }\n\n      function processInit() {\n        var callback = parseCallback(window.location.href);\n\n        if (callback) {\n          window.history.replaceState(window.history.state, null, callback.newUrl);\n        }\n\n        if (callback && callback.valid) {\n          return setupCheckLoginIframe().then(function () {\n            processCallback(callback, initPromise);\n          }).catch(function (e) {\n            initPromise.setError();\n          });\n        } else if (initOptions) {\n          if (initOptions.token && initOptions.refreshToken) {\n            setToken(initOptions.token, initOptions.refreshToken, initOptions.idToken);\n\n            if (loginIframe.enable) {\n              setupCheckLoginIframe().then(function () {\n                checkLoginIframe().then(function (unchanged) {\n                  if (unchanged) {\n                    kc.onAuthSuccess && kc.onAuthSuccess();\n                    initPromise.setSuccess();\n                    scheduleCheckIframe();\n                  } else {\n                    initPromise.setSuccess();\n                  }\n                }).catch(function () {\n                  initPromise.setError();\n                });\n              });\n            } else {\n              kc.updateToken(-1).then(function () {\n                kc.onAuthSuccess && kc.onAuthSuccess();\n                initPromise.setSuccess();\n              }).catch(function () {\n                kc.onAuthError && kc.onAuthError();\n\n                if (initOptions.onLoad) {\n                  onLoad();\n                } else {\n                  initPromise.setError();\n                }\n              });\n            }\n          } else if (initOptions.onLoad) {\n            onLoad();\n          } else {\n            initPromise.setSuccess();\n          }\n        } else {\n          initPromise.setSuccess();\n        }\n      }\n\n      configPromise.then(processInit);\n      configPromise.catch(function () {\n        promise.setError();\n      });\n      return promise.promise;\n    };\n\n    kc.login = function (options) {\n      return adapter.login(options);\n    };\n\n    function generateRandomData(len) {\n      // use web crypto APIs if possible\n      var array = null;\n      var crypto = window.crypto || window.msCrypto;\n\n      if (crypto && crypto.getRandomValues && window.Uint8Array) {\n        array = new Uint8Array(len);\n        crypto.getRandomValues(array);\n        return array;\n      } // fallback to Math random\n\n\n      array = new Array(len);\n\n      for (var j = 0; j < array.length; j++) {\n        array[j] = Math.floor(256 * Math.random());\n      }\n\n      return array;\n    }\n\n    function generateCodeVerifier(len) {\n      return generateRandomString(len, 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789');\n    }\n\n    function generateRandomString(len, alphabet) {\n      var randomData = generateRandomData(len);\n      var chars = new Array(len);\n\n      for (var i = 0; i < len; i++) {\n        chars[i] = alphabet.charCodeAt(randomData[i] % alphabet.length);\n      }\n\n      return String.fromCharCode.apply(null, chars);\n    }\n\n    function generatePkceChallenge(pkceMethod, codeVerifier) {\n      switch (pkceMethod) {\n        // The use of the \"plain\" method is considered insecure and therefore not supported.\n        case \"S256\":\n          // hash codeVerifier, then encode as url-safe base64 without padding\n          var hashBytes = new Uint8Array(sha256_imported.arrayBuffer(codeVerifier));\n          var encodedHash = base64js_imported.fromByteArray(hashBytes).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/\\=/g, '');\n          return encodedHash;\n\n        default:\n          throw 'Invalid value for pkceMethod';\n      }\n    }\n\n    kc.createLoginUrl = function (options) {\n      var state = createUUID();\n      var nonce = createUUID();\n      var redirectUri = adapter.redirectUri(options);\n      var callbackState = {\n        state: state,\n        nonce: nonce,\n        redirectUri: encodeURIComponent(redirectUri)\n      };\n\n      if (options && options.prompt) {\n        callbackState.prompt = options.prompt;\n      }\n\n      var baseUrl;\n\n      if (options && options.action == 'register') {\n        baseUrl = kc.endpoints.register();\n      } else {\n        baseUrl = kc.endpoints.authorize();\n      }\n\n      var scope;\n\n      if (options && options.scope) {\n        if (options.scope.indexOf(\"openid\") != -1) {\n          scope = options.scope;\n        } else {\n          scope = \"openid \" + options.scope;\n        }\n      } else {\n        scope = \"openid\";\n      }\n\n      var url = baseUrl + '?client_id=' + encodeURIComponent(kc.clientId) + '&redirect_uri=' + encodeURIComponent(redirectUri) + '&state=' + encodeURIComponent(state) + '&response_mode=' + encodeURIComponent(kc.responseMode) + '&response_type=' + encodeURIComponent(kc.responseType) + '&scope=' + encodeURIComponent(scope);\n\n      if (useNonce) {\n        url = url + '&nonce=' + encodeURIComponent(nonce);\n      }\n\n      if (options && options.prompt) {\n        url += '&prompt=' + encodeURIComponent(options.prompt);\n      }\n\n      if (options && options.maxAge) {\n        url += '&max_age=' + encodeURIComponent(options.maxAge);\n      }\n\n      if (options && options.loginHint) {\n        url += '&login_hint=' + encodeURIComponent(options.loginHint);\n      }\n\n      if (options && options.idpHint) {\n        url += '&kc_idp_hint=' + encodeURIComponent(options.idpHint);\n      }\n\n      if (options && options.locale) {\n        url += '&ui_locales=' + encodeURIComponent(options.locale);\n      }\n\n      if (kc.pkceMethod) {\n        var codeVerifier = generateCodeVerifier(96);\n        callbackState.pkceCodeVerifier = codeVerifier;\n        var pkceChallenge = generatePkceChallenge(kc.pkceMethod, codeVerifier);\n        url += '&code_challenge=' + pkceChallenge;\n        url += '&code_challenge_method=' + kc.pkceMethod;\n      }\n\n      callbackStorage.add(callbackState);\n      return url;\n    };\n\n    kc.logout = function (options) {\n      return adapter.logout(options);\n    };\n\n    kc.createLogoutUrl = function (options) {\n      var url = kc.endpoints.logout() + '?redirect_uri=' + encodeURIComponent(adapter.redirectUri(options, false));\n      return url;\n    };\n\n    kc.register = function (options) {\n      return adapter.register(options);\n    };\n\n    kc.createRegisterUrl = function (options) {\n      if (!options) {\n        options = {};\n      }\n\n      options.action = 'register';\n      return kc.createLoginUrl(options);\n    };\n\n    kc.createAccountUrl = function (options) {\n      var realm = getRealmUrl();\n      var url = undefined;\n\n      if (typeof realm !== 'undefined') {\n        url = realm + '/account' + '?referrer=' + encodeURIComponent(kc.clientId) + '&referrer_uri=' + encodeURIComponent(adapter.redirectUri(options));\n      }\n\n      return url;\n    };\n\n    kc.accountManagement = function () {\n      return adapter.accountManagement();\n    };\n\n    kc.hasRealmRole = function (role) {\n      var access = kc.realmAccess;\n      return !!access && access.roles.indexOf(role) >= 0;\n    };\n\n    kc.hasResourceRole = function (role, resource) {\n      if (!kc.resourceAccess) {\n        return false;\n      }\n\n      var access = kc.resourceAccess[resource || kc.clientId];\n      return !!access && access.roles.indexOf(role) >= 0;\n    };\n\n    kc.loadUserProfile = function () {\n      var url = getRealmUrl() + '/account';\n      var req = new XMLHttpRequest();\n      req.open('GET', url, true);\n      req.setRequestHeader('Accept', 'application/json');\n      req.setRequestHeader('Authorization', 'bearer ' + kc.token);\n      var promise = createPromise();\n\n      req.onreadystatechange = function () {\n        if (req.readyState == 4) {\n          if (req.status == 200) {\n            kc.profile = JSON.parse(req.responseText);\n            promise.setSuccess(kc.profile);\n          } else {\n            promise.setError();\n          }\n        }\n      };\n\n      req.send();\n      return promise.promise;\n    };\n\n    kc.loadUserInfo = function () {\n      var url = kc.endpoints.userinfo();\n      var req = new XMLHttpRequest();\n      req.open('GET', url, true);\n      req.setRequestHeader('Accept', 'application/json');\n      req.setRequestHeader('Authorization', 'bearer ' + kc.token);\n      var promise = createPromise();\n\n      req.onreadystatechange = function () {\n        if (req.readyState == 4) {\n          if (req.status == 200) {\n            kc.userInfo = JSON.parse(req.responseText);\n            promise.setSuccess(kc.userInfo);\n          } else {\n            promise.setError();\n          }\n        }\n      };\n\n      req.send();\n      return promise.promise;\n    };\n\n    kc.isTokenExpired = function (minValidity) {\n      if (!kc.tokenParsed || !kc.refreshToken && kc.flow != 'implicit') {\n        throw 'Not authenticated';\n      }\n\n      if (kc.timeSkew == null) {\n        logInfo('[KEYCLOAK] Unable to determine if token is expired as timeskew is not set');\n        return true;\n      }\n\n      var expiresIn = kc.tokenParsed['exp'] - Math.ceil(new Date().getTime() / 1000) + kc.timeSkew;\n\n      if (minValidity) {\n        if (isNaN(minValidity)) {\n          throw 'Invalid minValidity';\n        }\n\n        expiresIn -= minValidity;\n      }\n\n      return expiresIn < 0;\n    };\n\n    kc.updateToken = function (minValidity) {\n      var promise = createPromise();\n\n      if (!kc.refreshToken) {\n        promise.setError();\n        return promise.promise;\n      }\n\n      minValidity = minValidity || 5;\n\n      var exec = function exec() {\n        var refreshToken = false;\n\n        if (minValidity == -1) {\n          refreshToken = true;\n          logInfo('[KEYCLOAK] Refreshing token: forced refresh');\n        } else if (!kc.tokenParsed || kc.isTokenExpired(minValidity)) {\n          refreshToken = true;\n          logInfo('[KEYCLOAK] Refreshing token: token expired');\n        }\n\n        if (!refreshToken) {\n          promise.setSuccess(false);\n        } else {\n          var params = 'grant_type=refresh_token&' + 'refresh_token=' + kc.refreshToken;\n          var url = kc.endpoints.token();\n          refreshQueue.push(promise);\n\n          if (refreshQueue.length == 1) {\n            var req = new XMLHttpRequest();\n            req.open('POST', url, true);\n            req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n            req.withCredentials = true;\n            params += '&client_id=' + encodeURIComponent(kc.clientId);\n            var timeLocal = new Date().getTime();\n\n            req.onreadystatechange = function () {\n              if (req.readyState == 4) {\n                if (req.status == 200) {\n                  logInfo('[KEYCLOAK] Token refreshed');\n                  timeLocal = (timeLocal + new Date().getTime()) / 2;\n                  var tokenResponse = JSON.parse(req.responseText);\n                  setToken(tokenResponse['access_token'], tokenResponse['refresh_token'], tokenResponse['id_token'], timeLocal);\n                  kc.onAuthRefreshSuccess && kc.onAuthRefreshSuccess();\n\n                  for (var p = refreshQueue.pop(); p != null; p = refreshQueue.pop()) {\n                    p.setSuccess(true);\n                  }\n                } else {\n                  logWarn('[KEYCLOAK] Failed to refresh token');\n\n                  if (req.status == 400) {\n                    kc.clearToken();\n                  }\n\n                  kc.onAuthRefreshError && kc.onAuthRefreshError();\n\n                  for (var p = refreshQueue.pop(); p != null; p = refreshQueue.pop()) {\n                    p.setError(true);\n                  }\n                }\n              }\n            };\n\n            req.send(params);\n          }\n        }\n      };\n\n      if (loginIframe.enable) {\n        var iframePromise = checkLoginIframe();\n        iframePromise.then(function () {\n          exec();\n        }).catch(function () {\n          promise.setError();\n        });\n      } else {\n        exec();\n      }\n\n      return promise.promise;\n    };\n\n    kc.clearToken = function () {\n      if (kc.token) {\n        setToken(null, null, null);\n        kc.onAuthLogout && kc.onAuthLogout();\n\n        if (kc.loginRequired) {\n          kc.login();\n        }\n      }\n    };\n\n    function getRealmUrl() {\n      if (typeof kc.authServerUrl !== 'undefined') {\n        if (kc.authServerUrl.charAt(kc.authServerUrl.length - 1) == '/') {\n          return kc.authServerUrl + 'realms/' + encodeURIComponent(kc.realm);\n        } else {\n          return kc.authServerUrl + '/realms/' + encodeURIComponent(kc.realm);\n        }\n      } else {\n        return undefined;\n      }\n    }\n\n    function getOrigin() {\n      if (!window.location.origin) {\n        return window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? ':' + window.location.port : '');\n      } else {\n        return window.location.origin;\n      }\n    }\n\n    function processCallback(oauth, promise) {\n      var code = oauth.code;\n      var error = oauth.error;\n      var prompt = oauth.prompt;\n      var timeLocal = new Date().getTime();\n\n      if (error) {\n        if (prompt != 'none') {\n          var errorData = {\n            error: error,\n            error_description: oauth.error_description\n          };\n          kc.onAuthError && kc.onAuthError(errorData);\n          promise && promise.setError(errorData);\n        } else {\n          promise && promise.setSuccess();\n        }\n\n        return;\n      } else if (kc.flow != 'standard' && (oauth.access_token || oauth.id_token)) {\n        authSuccess(oauth.access_token, null, oauth.id_token, true);\n      }\n\n      if (kc.flow != 'implicit' && code) {\n        var params = 'code=' + code + '&grant_type=authorization_code';\n        var url = kc.endpoints.token();\n        var req = new XMLHttpRequest();\n        req.open('POST', url, true);\n        req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n        params += '&client_id=' + encodeURIComponent(kc.clientId);\n        params += '&redirect_uri=' + oauth.redirectUri;\n\n        if (oauth.pkceCodeVerifier) {\n          params += '&code_verifier=' + oauth.pkceCodeVerifier;\n        }\n\n        req.withCredentials = true;\n\n        req.onreadystatechange = function () {\n          if (req.readyState == 4) {\n            if (req.status == 200) {\n              var tokenResponse = JSON.parse(req.responseText);\n              authSuccess(tokenResponse['access_token'], tokenResponse['refresh_token'], tokenResponse['id_token'], kc.flow === 'standard');\n              scheduleCheckIframe();\n            } else {\n              kc.onAuthError && kc.onAuthError();\n              promise && promise.setError();\n            }\n          }\n        };\n\n        req.send(params);\n      }\n\n      function authSuccess(accessToken, refreshToken, idToken, fulfillPromise) {\n        timeLocal = (timeLocal + new Date().getTime()) / 2;\n        setToken(accessToken, refreshToken, idToken, timeLocal);\n\n        if (useNonce && (kc.tokenParsed && kc.tokenParsed.nonce != oauth.storedNonce || kc.refreshTokenParsed && kc.refreshTokenParsed.nonce != oauth.storedNonce || kc.idTokenParsed && kc.idTokenParsed.nonce != oauth.storedNonce)) {\n          logInfo('[KEYCLOAK] Invalid nonce, clearing token');\n          kc.clearToken();\n          promise && promise.setError();\n        } else {\n          if (fulfillPromise) {\n            kc.onAuthSuccess && kc.onAuthSuccess();\n            promise && promise.setSuccess();\n          }\n        }\n      }\n    }\n\n    function loadConfig(url) {\n      var promise = createPromise();\n      var configUrl;\n\n      if (!config) {\n        configUrl = 'keycloak.json';\n      } else if (typeof config === 'string') {\n        configUrl = config;\n      }\n\n      function setupOidcEndoints(oidcConfiguration) {\n        if (!oidcConfiguration) {\n          kc.endpoints = {\n            authorize: function authorize() {\n              return getRealmUrl() + '/protocol/openid-connect/auth';\n            },\n            token: function token() {\n              return getRealmUrl() + '/protocol/openid-connect/token';\n            },\n            logout: function logout() {\n              return getRealmUrl() + '/protocol/openid-connect/logout';\n            },\n            checkSessionIframe: function checkSessionIframe() {\n              var src = getRealmUrl() + '/protocol/openid-connect/login-status-iframe.html';\n\n              if (kc.iframeVersion) {\n                src = src + '?version=' + kc.iframeVersion;\n              }\n\n              return src;\n            },\n            register: function register() {\n              return getRealmUrl() + '/protocol/openid-connect/registrations';\n            },\n            userinfo: function userinfo() {\n              return getRealmUrl() + '/protocol/openid-connect/userinfo';\n            }\n          };\n        } else {\n          kc.endpoints = {\n            authorize: function authorize() {\n              return oidcConfiguration.authorization_endpoint;\n            },\n            token: function token() {\n              return oidcConfiguration.token_endpoint;\n            },\n            logout: function logout() {\n              if (!oidcConfiguration.end_session_endpoint) {\n                throw \"Not supported by the OIDC server\";\n              }\n\n              return oidcConfiguration.end_session_endpoint;\n            },\n            checkSessionIframe: function checkSessionIframe() {\n              if (!oidcConfiguration.check_session_iframe) {\n                throw \"Not supported by the OIDC server\";\n              }\n\n              return oidcConfiguration.check_session_iframe;\n            },\n            register: function register() {\n              throw 'Redirection to \"Register user\" page not supported in standard OIDC mode';\n            },\n            userinfo: function userinfo() {\n              if (!oidcConfiguration.userinfo_endpoint) {\n                throw \"Not supported by the OIDC server\";\n              }\n\n              return oidcConfiguration.userinfo_endpoint;\n            }\n          };\n        }\n      }\n\n      if (configUrl) {\n        var req = new XMLHttpRequest();\n        req.open('GET', configUrl, true);\n        req.setRequestHeader('Accept', 'application/json');\n\n        req.onreadystatechange = function () {\n          if (req.readyState == 4) {\n            if (req.status == 200 || fileLoaded(req)) {\n              var config = JSON.parse(req.responseText);\n              kc.authServerUrl = config['auth-server-url'];\n              kc.realm = config['realm'];\n              kc.clientId = config['resource'];\n              setupOidcEndoints(null);\n              promise.setSuccess();\n            } else {\n              promise.setError();\n            }\n          }\n        };\n\n        req.send();\n      } else {\n        if (!config.clientId) {\n          throw 'clientId missing';\n        }\n\n        kc.clientId = config.clientId;\n        var oidcProvider = config['oidcProvider'];\n\n        if (!oidcProvider) {\n          if (!config['url']) {\n            var scripts = document.getElementsByTagName('script');\n\n            for (var i = 0; i < scripts.length; i++) {\n              if (scripts[i].src.match(/.*keycloak\\.js/)) {\n                config.url = scripts[i].src.substr(0, scripts[i].src.indexOf('/js/keycloak.js'));\n                break;\n              }\n            }\n          }\n\n          if (!config.realm) {\n            throw 'realm missing';\n          }\n\n          kc.authServerUrl = config.url;\n          kc.realm = config.realm;\n          setupOidcEndoints(null);\n          promise.setSuccess();\n        } else {\n          if (typeof oidcProvider === 'string') {\n            var oidcProviderConfigUrl;\n\n            if (oidcProvider.charAt(oidcProvider.length - 1) == '/') {\n              oidcProviderConfigUrl = oidcProvider + '.well-known/openid-configuration';\n            } else {\n              oidcProviderConfigUrl = oidcProvider + '/.well-known/openid-configuration';\n            }\n\n            var req = new XMLHttpRequest();\n            req.open('GET', oidcProviderConfigUrl, true);\n            req.setRequestHeader('Accept', 'application/json');\n\n            req.onreadystatechange = function () {\n              if (req.readyState == 4) {\n                if (req.status == 200 || fileLoaded(req)) {\n                  var oidcProviderConfig = JSON.parse(req.responseText);\n                  setupOidcEndoints(oidcProviderConfig);\n                  promise.setSuccess();\n                } else {\n                  promise.setError();\n                }\n              }\n            };\n\n            req.send();\n          } else {\n            setupOidcEndoints(oidcProvider);\n            promise.setSuccess();\n          }\n        }\n      }\n\n      return promise.promise;\n    }\n\n    function fileLoaded(xhr) {\n      return xhr.status == 0 && xhr.responseText && xhr.responseURL.startsWith('file:');\n    }\n\n    function setToken(token, refreshToken, idToken, timeLocal) {\n      if (kc.tokenTimeoutHandle) {\n        clearTimeout(kc.tokenTimeoutHandle);\n        kc.tokenTimeoutHandle = null;\n      }\n\n      if (refreshToken) {\n        kc.refreshToken = refreshToken;\n        kc.refreshTokenParsed = decodeToken(refreshToken);\n      } else {\n        delete kc.refreshToken;\n        delete kc.refreshTokenParsed;\n      }\n\n      if (idToken) {\n        kc.idToken = idToken;\n        kc.idTokenParsed = decodeToken(idToken);\n      } else {\n        delete kc.idToken;\n        delete kc.idTokenParsed;\n      }\n\n      if (token) {\n        kc.token = token;\n        kc.tokenParsed = decodeToken(token);\n        kc.sessionId = kc.tokenParsed.session_state;\n        kc.authenticated = true;\n        kc.subject = kc.tokenParsed.sub;\n        kc.realmAccess = kc.tokenParsed.realm_access;\n        kc.resourceAccess = kc.tokenParsed.resource_access;\n\n        if (timeLocal) {\n          kc.timeSkew = Math.floor(timeLocal / 1000) - kc.tokenParsed.iat;\n        }\n\n        if (kc.timeSkew != null) {\n          logInfo('[KEYCLOAK] Estimated time difference between browser and server is ' + kc.timeSkew + ' seconds');\n\n          if (kc.onTokenExpired) {\n            var expiresIn = (kc.tokenParsed['exp'] - new Date().getTime() / 1000 + kc.timeSkew) * 1000;\n            logInfo('[KEYCLOAK] Token expires in ' + Math.round(expiresIn / 1000) + ' s');\n\n            if (expiresIn <= 0) {\n              kc.onTokenExpired();\n            } else {\n              kc.tokenTimeoutHandle = setTimeout(kc.onTokenExpired, expiresIn);\n            }\n          }\n        }\n      } else {\n        delete kc.token;\n        delete kc.tokenParsed;\n        delete kc.subject;\n        delete kc.realmAccess;\n        delete kc.resourceAccess;\n        kc.authenticated = false;\n      }\n    }\n\n    function decodeToken(str) {\n      str = str.split('.')[1];\n      str = str.replace('/-/g', '+');\n      str = str.replace('/_/g', '/');\n\n      switch (str.length % 4) {\n        case 0:\n          break;\n\n        case 2:\n          str += '==';\n          break;\n\n        case 3:\n          str += '=';\n          break;\n\n        default:\n          throw 'Invalid token';\n      }\n\n      str = (str + '===').slice(0, str.length + str.length % 4);\n      str = str.replace(/-/g, '+').replace(/_/g, '/');\n      str = decodeURIComponent(escape(atob(str)));\n      str = JSON.parse(str);\n      return str;\n    }\n\n    function createUUID() {\n      var hexDigits = '0123456789abcdef';\n      var s = generateRandomString(36, hexDigits).split(\"\");\n      s[14] = '4';\n      s[19] = hexDigits.substr(s[19] & 0x3 | 0x8, 1);\n      s[8] = s[13] = s[18] = s[23] = '-';\n      var uuid = s.join('');\n      return uuid;\n    }\n\n    function parseCallback(url) {\n      var oauth = parseCallbackUrl(url);\n\n      if (!oauth) {\n        return;\n      }\n\n      var oauthState = callbackStorage.get(oauth.state);\n\n      if (oauthState) {\n        oauth.valid = true;\n        oauth.redirectUri = oauthState.redirectUri;\n        oauth.storedNonce = oauthState.nonce;\n        oauth.prompt = oauthState.prompt;\n        oauth.pkceCodeVerifier = oauthState.pkceCodeVerifier;\n      }\n\n      return oauth;\n    }\n\n    function parseCallbackUrl(url) {\n      var supportedParams;\n\n      switch (kc.flow) {\n        case 'standard':\n          supportedParams = ['code', 'state', 'session_state'];\n          break;\n\n        case 'implicit':\n          supportedParams = ['access_token', 'token_type', 'id_token', 'state', 'session_state', 'expires_in'];\n          break;\n\n        case 'hybrid':\n          supportedParams = ['access_token', 'id_token', 'code', 'state', 'session_state'];\n          break;\n      }\n\n      supportedParams.push('error');\n      supportedParams.push('error_description');\n      supportedParams.push('error_uri');\n      var queryIndex = url.indexOf('?');\n      var fragmentIndex = url.indexOf('#');\n      var newUrl;\n      var parsed;\n\n      if (kc.responseMode === 'query' && queryIndex !== -1) {\n        newUrl = url.substring(0, queryIndex);\n        parsed = parseCallbackParams(url.substring(queryIndex + 1, fragmentIndex !== -1 ? fragmentIndex : url.length), supportedParams);\n\n        if (parsed.paramsString !== '') {\n          newUrl += '?' + parsed.paramsString;\n        }\n\n        if (fragmentIndex !== -1) {\n          newUrl += url.substring(fragmentIndex);\n        }\n      } else if (kc.responseMode === 'fragment' && fragmentIndex !== -1) {\n        newUrl = url.substring(0, fragmentIndex);\n        parsed = parseCallbackParams(url.substring(fragmentIndex + 1), supportedParams);\n\n        if (parsed.paramsString !== '') {\n          newUrl += '#' + parsed.paramsString;\n        }\n      }\n\n      if (parsed && parsed.oauthParams) {\n        if (kc.flow === 'standard' || kc.flow === 'hybrid') {\n          if ((parsed.oauthParams.code || parsed.oauthParams.error) && parsed.oauthParams.state) {\n            parsed.oauthParams.newUrl = newUrl;\n            return parsed.oauthParams;\n          }\n        } else if (kc.flow === 'implicit') {\n          if ((parsed.oauthParams.access_token || parsed.oauthParams.error) && parsed.oauthParams.state) {\n            parsed.oauthParams.newUrl = newUrl;\n            return parsed.oauthParams;\n          }\n        }\n      }\n    }\n\n    function parseCallbackParams(paramsString, supportedParams) {\n      var p = paramsString.split('&');\n      var result = {\n        paramsString: '',\n        oauthParams: {}\n      };\n\n      for (var i = 0; i < p.length; i++) {\n        var split = p[i].indexOf(\"=\");\n        var key = p[i].slice(0, split);\n\n        if (supportedParams.indexOf(key) !== -1) {\n          result.oauthParams[key] = p[i].slice(split + 1);\n        } else {\n          if (result.paramsString !== '') {\n            result.paramsString += '&';\n          }\n\n          result.paramsString += p[i];\n        }\n      }\n\n      return result;\n    }\n\n    function createPromise() {\n      // Need to create a native Promise which also preserves the\n      // interface of the custom promise type previously used by the API\n      var p = {\n        setSuccess: function setSuccess(result) {\n          p.resolve(result);\n        },\n        setError: function setError(result) {\n          p.reject(result);\n        }\n      };\n      p.promise = new KeycloakPromise(function (resolve, reject) {\n        p.resolve = resolve;\n        p.reject = reject;\n      });\n      return p;\n    }\n\n    function setupCheckLoginIframe() {\n      var promise = createPromise();\n\n      if (!loginIframe.enable) {\n        promise.setSuccess();\n        return promise.promise;\n      }\n\n      if (loginIframe.iframe) {\n        promise.setSuccess();\n        return promise.promise;\n      }\n\n      var iframe = document.createElement('iframe');\n      loginIframe.iframe = iframe;\n\n      iframe.onload = function () {\n        var authUrl = kc.endpoints.authorize();\n\n        if (authUrl.charAt(0) === '/') {\n          loginIframe.iframeOrigin = getOrigin();\n        } else {\n          loginIframe.iframeOrigin = authUrl.substring(0, authUrl.indexOf('/', 8));\n        }\n\n        promise.setSuccess();\n      };\n\n      var src = kc.endpoints.checkSessionIframe();\n      iframe.setAttribute('src', src);\n      iframe.setAttribute('title', 'keycloak-session-iframe');\n      iframe.style.display = 'none';\n      document.body.appendChild(iframe);\n\n      var messageCallback = function messageCallback(event) {\n        if (event.origin !== loginIframe.iframeOrigin || loginIframe.iframe.contentWindow !== event.source) {\n          return;\n        }\n\n        if (!(event.data == 'unchanged' || event.data == 'changed' || event.data == 'error')) {\n          return;\n        }\n\n        if (event.data != 'unchanged') {\n          kc.clearToken();\n        }\n\n        var callbacks = loginIframe.callbackList.splice(0, loginIframe.callbackList.length);\n\n        for (var i = callbacks.length - 1; i >= 0; --i) {\n          var promise = callbacks[i];\n\n          if (event.data == 'error') {\n            promise.setError();\n          } else {\n            promise.setSuccess(event.data == 'unchanged');\n          }\n        }\n      };\n\n      window.addEventListener('message', messageCallback, false);\n      return promise.promise;\n    }\n\n    function scheduleCheckIframe() {\n      if (loginIframe.enable) {\n        if (kc.token) {\n          setTimeout(function () {\n            checkLoginIframe().then(function (unchanged) {\n              if (unchanged) {\n                scheduleCheckIframe();\n              }\n            });\n          }, loginIframe.interval * 1000);\n        }\n      }\n    }\n\n    function checkLoginIframe() {\n      var promise = createPromise();\n\n      if (loginIframe.iframe && loginIframe.iframeOrigin) {\n        var msg = kc.clientId + ' ' + (kc.sessionId ? kc.sessionId : '');\n        loginIframe.callbackList.push(promise);\n        var origin = loginIframe.iframeOrigin;\n\n        if (loginIframe.callbackList.length == 1) {\n          loginIframe.iframe.contentWindow.postMessage(msg, origin);\n        }\n      } else {\n        promise.setSuccess();\n      }\n\n      return promise.promise;\n    }\n\n    function loadAdapter(type) {\n      if (!type || type == 'default') {\n        return {\n          login: function login(options) {\n            window.location.replace(kc.createLoginUrl(options));\n            return createPromise().promise;\n          },\n          logout: function logout(options) {\n            window.location.replace(kc.createLogoutUrl(options));\n            return createPromise().promise;\n          },\n          register: function register(options) {\n            window.location.replace(kc.createRegisterUrl(options));\n            return createPromise().promise;\n          },\n          accountManagement: function accountManagement() {\n            var accountUrl = kc.createAccountUrl();\n\n            if (typeof accountUrl !== 'undefined') {\n              window.location.href = accountUrl;\n            } else {\n              throw \"Not supported by the OIDC server\";\n            }\n\n            return createPromise().promise;\n          },\n          redirectUri: function redirectUri(options, encodeHash) {\n            if (arguments.length == 1) {\n              encodeHash = true;\n            }\n\n            if (options && options.redirectUri) {\n              return options.redirectUri;\n            } else if (kc.redirectUri) {\n              return kc.redirectUri;\n            } else {\n              return location.href;\n            }\n          }\n        };\n      }\n\n      if (type == 'cordova') {\n        loginIframe.enable = false;\n\n        var cordovaOpenWindowWrapper = function cordovaOpenWindowWrapper(loginUrl, target, options) {\n          if (window.cordova && window.cordova.InAppBrowser) {\n            // Use inappbrowser for IOS and Android if available\n            return window.cordova.InAppBrowser.open(loginUrl, target, options);\n          } else {\n            return window.open(loginUrl, target, options);\n          }\n        };\n\n        var shallowCloneCordovaOptions = function shallowCloneCordovaOptions(userOptions) {\n          if (userOptions && userOptions.cordovaOptions) {\n            return Object.keys(userOptions.cordovaOptions).reduce(function (options, optionName) {\n              options[optionName] = userOptions.cordovaOptions[optionName];\n              return options;\n            }, {});\n          } else {\n            return {};\n          }\n        };\n\n        var formatCordovaOptions = function formatCordovaOptions(cordovaOptions) {\n          return Object.keys(cordovaOptions).reduce(function (options, optionName) {\n            options.push(optionName + \"=\" + cordovaOptions[optionName]);\n            return options;\n          }, []).join(\",\");\n        };\n\n        var createCordovaOptions = function createCordovaOptions(userOptions) {\n          var cordovaOptions = shallowCloneCordovaOptions(userOptions);\n          cordovaOptions.location = 'no';\n\n          if (userOptions && userOptions.prompt == 'none') {\n            cordovaOptions.hidden = 'yes';\n          }\n\n          return formatCordovaOptions(cordovaOptions);\n        };\n\n        return {\n          login: function login(options) {\n            var promise = createPromise();\n            var cordovaOptions = createCordovaOptions(options);\n            var loginUrl = kc.createLoginUrl(options);\n            var ref = cordovaOpenWindowWrapper(loginUrl, '_blank', cordovaOptions);\n            var completed = false;\n            var closed = false;\n\n            var closeBrowser = function closeBrowser() {\n              closed = true;\n              ref.close();\n            };\n\n            ref.addEventListener('loadstart', function (event) {\n              if (event.url.indexOf('http://localhost') == 0) {\n                var callback = parseCallback(event.url);\n                processCallback(callback, promise);\n                closeBrowser();\n                completed = true;\n              }\n            });\n            ref.addEventListener('loaderror', function (event) {\n              if (!completed) {\n                if (event.url.indexOf('http://localhost') == 0) {\n                  var callback = parseCallback(event.url);\n                  processCallback(callback, promise);\n                  closeBrowser();\n                  completed = true;\n                } else {\n                  promise.setError();\n                  closeBrowser();\n                }\n              }\n            });\n            ref.addEventListener('exit', function (event) {\n              if (!closed) {\n                promise.setError({\n                  reason: \"closed_by_user\"\n                });\n              }\n            });\n            return promise.promise;\n          },\n          logout: function logout(options) {\n            var promise = createPromise();\n            var logoutUrl = kc.createLogoutUrl(options);\n            var ref = cordovaOpenWindowWrapper(logoutUrl, '_blank', 'location=no,hidden=yes');\n            var error;\n            ref.addEventListener('loadstart', function (event) {\n              if (event.url.indexOf('http://localhost') == 0) {\n                ref.close();\n              }\n            });\n            ref.addEventListener('loaderror', function (event) {\n              if (event.url.indexOf('http://localhost') == 0) {\n                ref.close();\n              } else {\n                error = true;\n                ref.close();\n              }\n            });\n            ref.addEventListener('exit', function (event) {\n              if (error) {\n                promise.setError();\n              } else {\n                kc.clearToken();\n                promise.setSuccess();\n              }\n            });\n            return promise.promise;\n          },\n          register: function register(options) {\n            var promise = createPromise();\n            var registerUrl = kc.createRegisterUrl();\n            var cordovaOptions = createCordovaOptions(options);\n            var ref = cordovaOpenWindowWrapper(registerUrl, '_blank', cordovaOptions);\n            ref.addEventListener('loadstart', function (event) {\n              if (event.url.indexOf('http://localhost') == 0) {\n                ref.close();\n                var oauth = parseCallback(event.url);\n                processCallback(oauth, promise);\n              }\n            });\n            return promise.promise;\n          },\n          accountManagement: function accountManagement() {\n            var accountUrl = kc.createAccountUrl();\n\n            if (typeof accountUrl !== 'undefined') {\n              var ref = cordovaOpenWindowWrapper(accountUrl, '_blank', 'location=no');\n              ref.addEventListener('loadstart', function (event) {\n                if (event.url.indexOf('http://localhost') == 0) {\n                  ref.close();\n                }\n              });\n            } else {\n              throw \"Not supported by the OIDC server\";\n            }\n          },\n          redirectUri: function redirectUri(options) {\n            return 'http://localhost';\n          }\n        };\n      }\n\n      if (type == 'cordova-native') {\n        loginIframe.enable = false;\n        return {\n          login: function login(options) {\n            var promise = createPromise();\n            var loginUrl = kc.createLoginUrl(options);\n            universalLinks.subscribe('keycloak', function (event) {\n              universalLinks.unsubscribe('keycloak');\n              window.cordova.plugins.browsertab.close();\n              var oauth = parseCallback(event.url);\n              processCallback(oauth, promise);\n            });\n            window.cordova.plugins.browsertab.openUrl(loginUrl);\n            return promise.promise;\n          },\n          logout: function logout(options) {\n            var promise = createPromise();\n            var logoutUrl = kc.createLogoutUrl(options);\n            universalLinks.subscribe('keycloak', function (event) {\n              universalLinks.unsubscribe('keycloak');\n              window.cordova.plugins.browsertab.close();\n              kc.clearToken();\n              promise.setSuccess();\n            });\n            window.cordova.plugins.browsertab.openUrl(logoutUrl);\n            return promise.promise;\n          },\n          register: function register(options) {\n            var promise = createPromise();\n            var registerUrl = kc.createRegisterUrl(options);\n            universalLinks.subscribe('keycloak', function (event) {\n              universalLinks.unsubscribe('keycloak');\n              window.cordova.plugins.browsertab.close();\n              var oauth = parseCallback(event.url);\n              processCallback(oauth, promise);\n            });\n            window.cordova.plugins.browsertab.openUrl(registerUrl);\n            return promise.promise;\n          },\n          accountManagement: function accountManagement() {\n            var accountUrl = kc.createAccountUrl();\n\n            if (typeof accountUrl !== 'undefined') {\n              window.cordova.plugins.browsertab.openUrl(accountUrl);\n            } else {\n              throw \"Not supported by the OIDC server\";\n            }\n          },\n          redirectUri: function redirectUri(options) {\n            if (options && options.redirectUri) {\n              return options.redirectUri;\n            } else if (kc.redirectUri) {\n              return kc.redirectUri;\n            } else {\n              return \"http://localhost\";\n            }\n          }\n        };\n      }\n\n      throw 'invalid adapter type: ' + type;\n    }\n\n    var LocalStorage = function LocalStorage() {\n      if (!(this instanceof LocalStorage)) {\n        return new LocalStorage();\n      }\n\n      localStorage.setItem('kc-test', 'test');\n      localStorage.removeItem('kc-test');\n      var cs = this;\n\n      function clearExpired() {\n        var time = new Date().getTime();\n\n        for (var i = 0; i < localStorage.length; i++) {\n          var key = localStorage.key(i);\n\n          if (key && key.indexOf('kc-callback-') == 0) {\n            var value = localStorage.getItem(key);\n\n            if (value) {\n              try {\n                var expires = JSON.parse(value).expires;\n\n                if (!expires || expires < time) {\n                  localStorage.removeItem(key);\n                }\n              } catch (err) {\n                localStorage.removeItem(key);\n              }\n            }\n          }\n        }\n      }\n\n      cs.get = function (state) {\n        if (!state) {\n          return;\n        }\n\n        var key = 'kc-callback-' + state;\n        var value = localStorage.getItem(key);\n\n        if (value) {\n          localStorage.removeItem(key);\n          value = JSON.parse(value);\n        }\n\n        clearExpired();\n        return value;\n      };\n\n      cs.add = function (state) {\n        clearExpired();\n        var key = 'kc-callback-' + state.state;\n        state.expires = new Date().getTime() + 60 * 60 * 1000;\n        localStorage.setItem(key, JSON.stringify(state));\n      };\n    };\n\n    var CookieStorage = function CookieStorage() {\n      if (!(this instanceof CookieStorage)) {\n        return new CookieStorage();\n      }\n\n      var cs = this;\n\n      cs.get = function (state) {\n        if (!state) {\n          return;\n        }\n\n        var value = getCookie('kc-callback-' + state);\n        setCookie('kc-callback-' + state, '', cookieExpiration(-100));\n\n        if (value) {\n          return JSON.parse(value);\n        }\n      };\n\n      cs.add = function (state) {\n        setCookie('kc-callback-' + state.state, JSON.stringify(state), cookieExpiration(60));\n      };\n\n      cs.removeItem = function (key) {\n        setCookie(key, '', cookieExpiration(-100));\n      };\n\n      var cookieExpiration = function cookieExpiration(minutes) {\n        var exp = new Date();\n        exp.setTime(exp.getTime() + minutes * 60 * 1000);\n        return exp;\n      };\n\n      var getCookie = function getCookie(key) {\n        var name = key + '=';\n        var ca = document.cookie.split(';');\n\n        for (var i = 0; i < ca.length; i++) {\n          var c = ca[i];\n\n          while (c.charAt(0) == ' ') {\n            c = c.substring(1);\n          }\n\n          if (c.indexOf(name) == 0) {\n            return c.substring(name.length, c.length);\n          }\n        }\n\n        return '';\n      };\n\n      var setCookie = function setCookie(key, value, expirationDate) {\n        var cookie = key + '=' + value + '; ' + 'expires=' + expirationDate.toUTCString() + '; ';\n        document.cookie = cookie;\n      };\n    };\n\n    function createCallbackStorage() {\n      try {\n        return new LocalStorage();\n      } catch (err) {}\n\n      return new CookieStorage();\n    }\n\n    function createLogger(fn) {\n      return function () {\n        if (kc.enableLogging) {\n          fn.apply(console, Array.prototype.slice.call(arguments));\n        }\n      };\n    }\n  }\n\n  return Keycloak;\n});","map":null,"metadata":{},"sourceType":"script"}